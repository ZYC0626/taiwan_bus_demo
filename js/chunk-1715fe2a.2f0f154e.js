(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1715fe2a"],{"0168":function(t,e,n){t.exports=n.p+"img/busStop_in.bee2e2f7.svg"},"107c":function(t,e,n){var o=n("d039"),i=n("da84"),r=i.RegExp;t.exports=o((function(){var t=r("(?<a>b)","g");return"b"!==t.exec("b").groups.a||"bc"!=="b".replace(t,"$<a>c")}))},11343:function(t,e,n){var o;
/** @license
 *
 *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
 *  Michigan Tech Research Institute (MTRI)
 *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */(function(i,r){o=function(){return r()}.call(e,n,e,t),void 0===o||(t.exports=o)})(0,(function(){var t,e,n;return this,n=function(t){return t instanceof n?t:this instanceof n?void(this._wrapped=t):new n(t)},t=function(t,e){return t.substring(0,e.length)===e},e=function(t,e){return t.substring(t.length-e.length)===e},n.delimiter=" ",n.isArray=function(t){return!(!t||t.constructor!==Array)},n.trim=function(n,o){o=o||" ";while(t(n,o))n=n.substring(1);while(e(n,o))n=n.substring(0,n.length-1);return n},n.Wkt=function(t){this.delimiter=n.delimiter||" ",this.wrapVertices=!0,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/},this._stripWhitespaceAndParens=function(t){var e=t.trim(),n=e.replace(/^\(?(.*?)\)?$/,"$1");return n},this.components=void 0,t&&"string"===typeof t?this.read(t):t&&void 0!==typeof t&&this.fromObject(t)},n.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case"multi":return!0;case"polyg":return!0;default:return!1}},n.Wkt.prototype.sameCoords=function(t,e){return t.x===e.x&&t.y===e.y},n.Wkt.prototype.fromObject=function(t){var e;return e=t.hasOwnProperty("type")&&t.hasOwnProperty("coordinates")?this.fromJson(t):this.deconstruct.call(this,t),this.components=e.components,this.isRectangle=e.isRectangle||!1,this.type=e.type,this},n.Wkt.prototype.toObject=function(t){var e=this.construct[this.type].call(this,t);return"object"!==typeof e||n.isArray(e)||(e.properties=this.properties),e},n.Wkt.prototype.toString=function(t){return this.write()},n.Wkt.prototype.fromJson=function(t){var e,o,i,r,c,s;if(this.type=t.type.toLowerCase(),this.components=[],t.hasOwnProperty("geometry"))return this.fromJson(t.geometry),this.properties=t.properties,this;if(r=t.coordinates,n.isArray(r[0])){for(e in r)if(r.hasOwnProperty(e))if(n.isArray(r[e][0])){for(o in s=[],r[e])if(r[e].hasOwnProperty(o))if(n.isArray(r[e][o][0])){for(i in c=[],r[e][o])r[e][o].hasOwnProperty(i)&&c.push({x:r[e][o][i][0],y:r[e][o][i][1]});s.push(c)}else s.push({x:r[e][o][0],y:r[e][o][1]});this.components.push(s)}else"multipoint"===this.type?this.components.push([{x:r[e][0],y:r[e][1]}]):this.components.push({x:r[e][0],y:r[e][1]})}else this.components.push({x:r[0],y:r[1]});return this},n.Wkt.prototype.toJson=function(){var t,e,o,i,r,c,s;if(t=this.components,e={coordinates:[],type:function(){var t,e,n;for(t in e=this.regExes.ogcTypes.exec(this.type).slice(1),n=[],e)e.hasOwnProperty(t)&&void 0!==e[t]&&n.push(e[t].toLowerCase().slice(0,1).toUpperCase()+e[t].toLowerCase().slice(1));return n}.call(this).join("")},"box"===this.type.toLowerCase()){for(o in e.type="Polygon",e.bbox=[],t)t.hasOwnProperty(o)&&(e.bbox=e.bbox.concat([t[o].x,t[o].y]));return e.coordinates=[[[t[0].x,t[0].y],[t[0].x,t[1].y],[t[1].x,t[1].y],[t[1].x,t[0].y],[t[0].x,t[0].y]]],e}for(o in t)if(t.hasOwnProperty(o))if(n.isArray(t[o])){for(i in s=[],t[o])if(t[o].hasOwnProperty(i))if(n.isArray(t[o][i])){for(r in c=[],t[o][i])t[o][i].hasOwnProperty(r)&&c.push([t[o][i][r].x,t[o][i][r].y]);s.push(c)}else t[o].length>1?s.push([t[o][i].x,t[o][i].y]):s=s.concat([t[o][i].x,t[o][i].y]);e.coordinates.push(s)}else t.length>1?e.coordinates.push([t[o].x,t[o].y]):e.coordinates=e.coordinates.concat([t[o].x,t[o].y]);return e},n.Wkt.prototype.merge=function(t){var e=this.type.slice(0,5);if(this.type!==t.type&&this.type.slice(5,this.type.length)!==t.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(e){case"point":this.components=[this.components.concat(t.components)];break;case"multi":this.components=this.components.concat("multi"===t.type.slice(0,5)?t.components:[t.components]);break;default:this.components=[this.components,t.components];break}return"multi"!==e&&(this.type="multi"+this.type),this},n.Wkt.prototype.read=function(t){var e;if(e=this.regExes.typeStr.exec(t),e)this.type=e[1].toLowerCase(),this.base=e[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else{if(!this.regExes.crudeJson.test(t))throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",message:"Invalid WKT string provided to read()"};if("object"!==typeof JSON||"function"!==typeof JSON.parse)throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};this.fromJson(JSON.parse(t))}return this},n.Wkt.prototype.write=function(t){var e,n,o;for(t=t||this.components,n=[],n.push(this.type.toUpperCase()+"("),e=0;e<t.length;e+=1){if(this.isCollection()&&e>0&&n.push(","),!this.extract[this.type])return null;o=this.extract[this.type].apply(this,[t[e]]),this.isCollection()&&"multipoint"!==this.type?n.push("("+o+")"):(n.push(o),e!==t.length-1&&"multipoint"!==this.type&&n.push(","))}return n.push(")"),n.join("")},n.Wkt.prototype.extract={point:function(t){return String(t.x)+this.delimiter+String(t.y)},multipoint:function(t){var e,n,o=[];for(e=0;e<t.length;e+=1)n=this.extract.point.apply(this,[t[e]]),this.wrapVertices&&(n="("+n+")"),o.push(n);return o.join(",")},linestring:function(t){return this.extract.point.apply(this,[t])},multilinestring:function(t){var e,n=[];if(t.length)for(e=0;e<t.length;e+=1)n.push(this.extract.linestring.apply(this,[t[e]]));else n.push(this.extract.point.apply(this,[t]));return n.join(",")},polygon:function(t){return this.extract.multilinestring.apply(this,[t])},multipolygon:function(t){var e,n=[];for(e=0;e<t.length;e+=1)n.push("("+this.extract.polygon.apply(this,[t[e]])+")");return n.join(",")},box:function(t){return this.extract.linestring.apply(this,[t])},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},n.Wkt.prototype.ingest={point:function(t){var e=n.trim(t).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(e[0])[0]),y:parseFloat(this.regExes.numeric.exec(e[1])[0])}]},multipoint:function(t){var e,o,i;for(o=[],i=n.trim(t).split(this.regExes.comma),e=0;e<i.length;e+=1)o.push(this.ingest.point.apply(this,[i[e]]));return o},linestring:function(t){var e,n,o;for(n=this.ingest.multipoint.apply(this,[t]),o=[],e=0;e<n.length;e+=1)o=o.concat(n[e]);return o},multilinestring:function(t){var e,o,i,r;for(o=[],r=n.trim(t).split(this.regExes.doubleParenComma),1===r.length&&(r=n.trim(t).split(this.regExes.parenComma)),e=0;e<r.length;e+=1)i=this._stripWhitespaceAndParens(r[e]),o.push(this.ingest.linestring.apply(this,[i]));return o},polygon:function(t){var e,o,i,r,c,s;for(s=n.trim(t).split(this.regExes.parenComma),i=[],e=0;e<s.length;e+=1){for(c=this._stripWhitespaceAndParens(s[e]).split(this.regExes.comma),r=[],o=0;o<c.length;o+=1){var a=c[o].split(this.regExes.spaces);if(a.length>2&&(a=a.filter((function(t){return""!=t}))),2===a.length){var u=a[0],b=a[1];r.push({x:parseFloat(u),y:parseFloat(b)})}}i.push(r)}return i},box:function(t){var e,n,o;for(n=this.ingest.multipoint.apply(this,[t]),o=[],e=0;e<n.length;e+=1)o=o.concat(n[e]);return o},multipolygon:function(t){var e,o,i,r;for(o=[],r=n.trim(t).split(this.regExes.doubleParenComma),e=0;e<r.length;e+=1)i=this._stripWhitespaceAndParens(r[e]),o.push(this.ingest.polygon.apply(this,[i]));return o},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},n}))},1276:function(t,e,n){"use strict";var o=n("2ba4"),i=n("c65b"),r=n("e330"),c=n("d784"),s=n("44e7"),a=n("825a"),u=n("1d80"),b=n("4840"),l=n("8aa5"),p=n("50c4"),h=n("577e"),f=n("dc4a"),d=n("f36a"),y=n("14c3"),m=n("9263"),O=n("9f7f"),k=n("d039"),g=O.UNSUPPORTED_Y,j=4294967295,v=Math.min,x=[].push,S=r(/./.exec),C=r(x),w=r("".slice),P=!k((function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var n="ab".split(t);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));c("split",(function(t,e,n){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,n){var r=h(u(this)),c=void 0===n?j:n>>>0;if(0===c)return[];if(void 0===t)return[r];if(!s(t))return i(e,r,t,c);var a,b,l,p=[],f=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),y=0,O=new RegExp(t.source,f+"g");while(a=i(m,O,r)){if(b=O.lastIndex,b>y&&(C(p,w(r,y,a.index)),a.length>1&&a.index<r.length&&o(x,p,d(a,1)),l=a[0].length,y=b,p.length>=c))break;O.lastIndex===a.index&&O.lastIndex++}return y===r.length?!l&&S(O,"")||C(p,""):C(p,w(r,y)),p.length>c?d(p,0,c):p}:"0".split(void 0,0).length?function(t,n){return void 0===t&&0===n?[]:i(e,this,t,n)}:e,[function(e,n){var o=u(this),c=void 0==e?void 0:f(e,t);return c?i(c,e,o,n):i(r,h(o),e,n)},function(t,o){var i=a(this),c=h(t),s=n(r,i,c,o,r!==e);if(s.done)return s.value;var u=b(i,RegExp),f=i.unicode,d=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(g?"g":"y"),m=new u(g?"^(?:"+i.source+")":i,d),O=void 0===o?j:o>>>0;if(0===O)return[];if(0===c.length)return null===y(m,c)?[c]:[];var k=0,x=0,S=[];while(x<c.length){m.lastIndex=g?0:x;var P,R=y(m,g?w(c,x):c);if(null===R||(P=v(p(m.lastIndex+(g?x:0)),c.length))===k)x=l(c,x,f);else{if(C(S,w(c,k,x)),S.length===O)return S;for(var N=1;N<=R.length-1;N++)if(C(S,R[N]),S.length===O)return S;x=k=P}}return C(S,w(c,k)),S}]}),!P,g)},"14c3":function(t,e,n){var o=n("da84"),i=n("c65b"),r=n("825a"),c=n("1626"),s=n("c6b6"),a=n("9263"),u=o.TypeError;t.exports=function(t,e){var n=t.exec;if(c(n)){var o=i(n,t,e);return null!==o&&r(o),o}if("RegExp"===s(t))return i(a,t,e);throw u("RegExp#exec called on incompatible receiver")}},"159b":function(t,e,n){var o=n("da84"),i=n("fdbc"),r=n("785a"),c=n("17c2"),s=n("9112"),a=function(t){if(t&&t.forEach!==c)try{s(t,"forEach",c)}catch(e){t.forEach=c}};for(var u in i)i[u]&&a(o[u]&&o[u].prototype);a(r)},"17c2":function(t,e,n){"use strict";var o=n("b727").forEach,i=n("a640"),r=i("forEach");t.exports=r?[].forEach:function(t){return o(this,t,arguments.length>1?arguments[1]:void 0)}},"464a":function(t,e,n){t.exports=n.p+"img/carbon_bus_w.21b33b66.svg"},"529f":function(t,e,n){t.exports=n.p+"img/walkbus.665fe3f1.svg"},"8aa5":function(t,e,n){"use strict";var o=n("6547").charAt;t.exports=function(t,e,n){return e+(n?o(t,e).length:1)}},"8fb6":function(t,e,n){"use strict";n.r(e);n("caad"),n("2532");var o=n("7a23"),i=n("42f0"),r=n.n(i),c={class:"h-100 d-flex flex-column"},s={class:"bread-bar"},a={class:"breadcrumb m-0 d-md-flex d-none"},u=Object(o["h"])("li",{class:"breadcrumb-item"},[Object(o["h"])("a",{href:"#"},"首頁")],-1),b={class:"breadcrumb-item active","aria-current":"page"},l={key:0},p={class:"mobile-control-bar d-flex d-md-none"},h={class:"city"},f=Object(o["h"])("span",{class:"material-icons"}," location_on ",-1),d={key:0},y={class:"tool"},m=Object(o["h"])("i",{class:"bi bi-pin-map me-1"},null,-1),O=Object(o["j"])("地圖 "),k=[m,O],g=Object(o["h"])("i",{class:"bi bi-clock me-1"},null,-1),j=Object(o["j"])("時刻表 "),v=[g,j],x=Object(o["h"])("i",{class:"bi bi-map me-1"},null,-1),S=Object(o["j"])("路線 "),C=[x,S],w={class:"map-wrap"},P={class:"route-search-area active"},R={class:"route-search-header"},N={class:"route-search-body"},I={class:"route-list"},T=["onClick"],L={class:"d-flex justify-content-between"},E={class:"title"},D={class:"icon"},U=["onClick"],A={key:0,class:"material-icons love"},B={key:1,class:"material-icons"},J={class:"d-flex justify-content-between"},M={class:"od"},_={class:"city"},$={key:0},q={class:"route-stop-area"},W=Object(o["h"])("span",{class:"material-icons"},"chevron_left",-1),G=Object(o["j"])(" 返回搜尋 "),z=[W,G],K={class:"refresh-bar"},Z={class:"time"},F=Object(o["h"])("span",{class:"material-icons"},"autorenew",-1),H=Object(o["j"])(" 立即更新 "),V=[F,H],Y={class:"route-stop-header"},X={class:"route-name"},Q=Object(o["h"])("span",{class:"material-icons"}," link ",-1),tt=[Q],et={key:0,class:"material-icons love"},nt={key:1,class:"material-icons"},ot={class:"nav nav-tabs",role:"tablist"},it={class:"nav-item od-nav",role:"presentation"},rt={key:0,class:"fw-700 truncateText"},ct={class:"nav-item od-nav",role:"presentation"},st={key:0,class:"fw-700 truncateText"},at={class:"route-stop-content"},ut={class:"tab-content py-3",id:"routeTabContent"},bt={key:0,class:"tab-pane fade show active",id:"go",role:"tabpanel"},lt={class:"route-stop-list"},pt=["onClick"],ht={key:0},ft={key:0},dt={key:1},yt={key:2},mt={key:1},Ot={key:2},kt={key:3},gt={key:4},jt={class:"stop-name"},vt={class:"plate-numb"},xt={key:0},St={key:1,class:"tab-pane fade",id:"back",role:"tabpanel"},Ct={class:"route-stop-list"},wt=["onClick"],Pt={key:0},Rt={key:0},Nt={key:1},It={key:2},Tt={key:1},Lt={key:2},Et={key:3},Dt={key:4},Ut={class:"plate-numb"},At={key:0},Bt=Object(o["h"])("img",{src:r.a,class:"icon-filter",alt:"gps-icon"},null,-1),Jt=[Bt],Mt=Object(o["h"])("div",{class:"map",id:"map"},null,-1);function _t(t,e,n,i,r,m){var O=Object(o["D"])("SearchKeyboard");return Object(o["w"])(),Object(o["g"])("div",c,[Object(o["h"])("div",s,[Object(o["h"])("ol",a,[u,Object(o["h"])("li",b,[r.city?(Object(o["w"])(),Object(o["g"])("span",l,Object(o["G"])(t.$filters.replaceCity(r.city)),1)):Object(o["f"])("",!0)])]),Object(o["h"])("div",p,[Object(o["h"])("div",h,[f,r.city?(Object(o["w"])(),Object(o["g"])("span",d,Object(o["G"])(t.$filters.replaceCity(r.city)),1)):Object(o["f"])("",!0)]),Object(o["h"])("div",y,[Object(o["h"])("div",{class:Object(o["q"])(["map",{active:"map"===r.mobileTool}]),onClick:e[0]||(e[0]=function(t){return m.showArea("map")})},k,2),r.stopOfRouteBack.length>0&&r.stopOfRouteTo.length>0?(Object(o["w"])(),Object(o["g"])("div",{key:0,class:Object(o["q"])(["time",{active:"time"===r.mobileTool}]),onClick:e[1]||(e[1]=function(t){return m.showArea("time")})},v,2)):Object(o["f"])("",!0),Object(o["h"])("div",{class:Object(o["q"])(["route",{active:"route"===r.mobileTool}]),onClick:e[2]||(e[2]=function(t){return m.showArea("route")})},C,2)])])]),Object(o["h"])("div",w,[Object(o["h"])("div",P,[Object(o["h"])("div",R,[Object(o["N"])(Object(o["h"])("input",{type:"search",class:"form-control",id:"routeNumber",placeholder:"請輸入公車路線","onUpdate:modelValue":e[3]||(e[3]=function(t){return r.routeKeyword=t})},null,512),[[o["J"],r.routeKeyword]])]),Object(o["h"])("div",N,[Object(o["h"])("ul",I,[(Object(o["w"])(!0),Object(o["g"])(o["a"],null,Object(o["B"])(r.routeList,(function(e){return Object(o["w"])(),Object(o["g"])("li",{class:"route-list-item",key:e.RouteUID,onClick:function(t){return m.toRouteDetailClick(e)}},[Object(o["h"])("div",L,[Object(o["h"])("div",E,Object(o["G"])(e.RouteName.Zh_tw),1),Object(o["h"])("div",D,[Object(o["h"])("a",{href:"#",onClick:Object(o["O"])((function(t){return m.updateLikes(e)}),["prevent"])},[r.buslikesId.includes(e.RouteUID)?(Object(o["w"])(),Object(o["g"])("span",A," favorite ")):(Object(o["w"])(),Object(o["g"])("span",B," favorite_border "))],8,U)])]),Object(o["h"])("div",J,[Object(o["h"])("div",M,Object(o["G"])(e.DepartureStopNameZh)+"-"+Object(o["G"])(e.DestinationStopNameZh),1),Object(o["h"])("div",_,[r.city?(Object(o["w"])(),Object(o["g"])("span",$,Object(o["G"])(t.$filters.replaceCity(r.city)),1)):Object(o["f"])("",!0)])])],8,T)})),128))])]),Object(o["k"])(O,{city:r.city,onEmitInput:m.updateInput},null,8,["city","onEmitInput"])]),Object(o["h"])("div",q,[Object(o["h"])("a",{href:"#",class:"return",onClick:e[4]||(e[4]=Object(o["O"])((function(t){return m.backToRouteSeachList()}),["prevent"]))},z),Object(o["h"])("div",K,[Object(o["h"])("div",Z,Object(o["G"])(r.refreshTime)+" 秒後更新",1),Object(o["h"])("a",{href:"#",class:"refresh ms-auto",onClick:e[5]||(e[5]=Object(o["O"])((function(t){return m.getStopOfRoute()}),["prevent"]))},V)]),Object(o["h"])("div",Y,[Object(o["h"])("div",X,[Object(o["h"])("a",{href:"#",onClick:e[6]||(e[6]=Object(o["O"])((function(t){return m.shareLink()}),["prevent"]))},tt),Object(o["j"])(" "+Object(o["G"])(r.selectRoute)+" ",1),Object(o["h"])("a",{href:"#",onClick:e[7]||(e[7]=Object(o["O"])((function(t){return m.updateLikes_(r.selectRoute,r.selectRouteUID,r.stopOfRouteBack[r.stopOfRouteBack.length-1].StopName.Zh_tw,r.stopOfRouteTo[r.stopOfRouteTo.length-1].StopName.Zh_tw,r.city)}),["prevent"]))},[r.buslikesId.includes(r.selectRouteUID)?(Object(o["w"])(),Object(o["g"])("span",et," favorite ")):(Object(o["w"])(),Object(o["g"])("span",nt," favorite_border "))])])]),Object(o["h"])("ul",ot,[Object(o["h"])("li",it,[Object(o["h"])("button",{class:Object(o["q"])(["nav-link",{active:"to"===r.toOrBack}]),id:"go-tab","data-bs-toggle":"tab","data-bs-target":"#go",type:"button",onClick:e[8]||(e[8]=function(t){return m.changeToOrBack("to")})},[r.stopOfRouteTo.length>0?(Object(o["w"])(),Object(o["g"])("div",rt,"往 "+Object(o["G"])(r.stopOfRouteTo[r.stopOfRouteTo.length-1].StopName.Zh_tw),1)):Object(o["f"])("",!0)],2)]),Object(o["h"])("li",ct,[Object(o["h"])("button",{class:Object(o["q"])(["nav-link",{active:"back"===r.toOrBack}]),id:"back-tab","data-bs-toggle":"tab","data-bs-target":"#back",type:"button",onClick:e[9]||(e[9]=function(t){return m.changeToOrBack("back")})},[r.stopOfRouteBack.length>0?(Object(o["w"])(),Object(o["g"])("div",st,"往 "+Object(o["G"])(r.stopOfRouteBack[r.stopOfRouteBack.length-1].StopName.Zh_tw),1)):Object(o["f"])("",!0)],2)])]),Object(o["h"])("div",at,[Object(o["h"])("div",ut,[r.stopOfRouteTo.length>0?(Object(o["w"])(),Object(o["g"])("div",bt,[Object(o["h"])("ul",lt,[(Object(o["w"])(!0),Object(o["g"])(o["a"],null,Object(o["B"])(r.stopOfRouteTo,(function(e){return Object(o["w"])(),Object(o["g"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return m.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(o["h"])("div",{class:Object(o["q"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",ht,[e.EstimateTime<=180&&e.PlateNumb?(Object(o["w"])(),Object(o["g"])("span",ft,"進站中")):e.EstimateTime<=180?(Object(o["w"])(),Object(o["g"])("span",dt,"即將進站")):(Object(o["w"])(),Object(o["g"])("span",yt,Object(o["G"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",mt,"尚未發車")):2===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",Ot,"交管不停靠")):3===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",kt,"末班車已過")):(Object(o["w"])(),Object(o["g"])("span",gt,"今日未營運"))],2),Object(o["h"])("div",jt,Object(o["G"])(e.StopName.Zh_tw),1),Object(o["h"])("div",vt,[e.PlateNumb?(Object(o["w"])(),Object(o["g"])("span",xt,Object(o["G"])(e.PlateNumb),1)):Object(o["f"])("",!0)]),Object(o["h"])("div",{class:Object(o["q"])(["status-dot",{"bus-on":e.PlateNumb}])},null,2)],8,pt)})),128))])])):Object(o["f"])("",!0),r.stopOfRouteBack.length>0?(Object(o["w"])(),Object(o["g"])("div",St,[Object(o["h"])("ul",Ct,[(Object(o["w"])(!0),Object(o["g"])(o["a"],null,Object(o["B"])(r.stopOfRouteBack,(function(e){return Object(o["w"])(),Object(o["g"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return m.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(o["h"])("div",{class:Object(o["q"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",Pt,[e.EstimateTime<=180&&e.PlateNumb?(Object(o["w"])(),Object(o["g"])("span",Rt,"進站中")):e.EstimateTime<=180?(Object(o["w"])(),Object(o["g"])("span",Nt,"即將進站")):(Object(o["w"])(),Object(o["g"])("span",It,Object(o["G"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",Tt,"尚未發車")):2===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",Lt,"交管不停靠")):3===e.StopStatus?(Object(o["w"])(),Object(o["g"])("span",Et,"末班車已過")):(Object(o["w"])(),Object(o["g"])("span",Dt,"今日未營運"))],2),Object(o["h"])("div",{class:Object(o["q"])(["stop-name",{active:e.PlateNumb,disconnect:0!==e.StopStatus}])},Object(o["G"])(e.StopName.Zh_tw),3),Object(o["h"])("div",Ut,[e.PlateNumb?(Object(o["w"])(),Object(o["g"])("span",At,Object(o["G"])(e.PlateNumb),1)):Object(o["f"])("",!0)]),Object(o["h"])("div",{class:Object(o["q"])(["status-dot",{"bus-on":e.PlateNumb,"bus-close":e.EstimateTime<=180}])},null,2)],8,wt)})),128))])])):Object(o["f"])("",!0)])])]),Object(o["h"])("div",{class:"gps-icon",onClick:e[10]||(e[10]=function(t){return m.locateGPS()})},Jt),Mt])])}n("99af"),n("b0c0"),n("d3b7"),n("159b"),n("e9c4"),n("d81d"),n("a434"),n("ac1f"),n("1276");var $t=n("e11e"),qt=n.n($t),Wt=n("11343"),Gt=n.n(Wt),zt={class:"route-search-keyboard"},Kt={key:0,class:"keyboard-content-taipei"},Zt={class:"keyboard-moreArea"},Ft={key:1,class:"keyboard-content-taipei"},Ht={key:2,class:"keyboard-content-taipei"},Vt={class:"keyboard-moreArea"},Yt={key:3,class:"keyboard-content"};function Xt(t,e,n,i,r,c){return Object(o["w"])(),Object(o["g"])("div",zt,["Taipei"===n.city||"NewTaipei"===n.city?(Object(o["w"])(),Object(o["g"])("div",Kt,[Object(o["h"])("button",{class:"btn keyboard-btn red",onClick:e[0]||(e[0]=function(t){return c.inputPrefix("紅")})},"紅"),Object(o["h"])("button",{class:"btn keyboard-btn blue",onClick:e[1]||(e[1]=function(t){return c.inputPrefix("藍")})},"藍"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[2]||(e[2]=function(t){return c.inputNumber("1")})},"1"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[3]||(e[3]=function(t){return c.inputNumber("2")})},"2"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[4]||(e[4]=function(t){return c.inputNumber("3")})},"3"),Object(o["h"])("button",{class:"btn keyboard-btn green",onClick:e[5]||(e[5]=function(t){return c.inputPrefix("綠")})},"綠"),Object(o["h"])("button",{class:"btn keyboard-btn brown",onClick:e[6]||(e[6]=function(t){return c.inputPrefix("棕")})},"棕"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[7]||(e[7]=function(t){return c.inputNumber("4")})},"4"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[8]||(e[8]=function(t){return c.inputNumber("5")})},"5"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[9]||(e[9]=function(t){return c.inputNumber("6")})},"6"),Object(o["h"])("button",{class:"btn keyboard-btn orange",onClick:e[10]||(e[10]=function(t){return c.inputPrefix("橘")})},"橘"),Object(o["h"])("button",{class:"btn keyboard-btn yellow",onClick:e[11]||(e[11]=function(t){return c.inputPrefix("黃")})},"黃"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[12]||(e[12]=function(t){return c.inputNumber("7")})},"7"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[13]||(e[13]=function(t){return c.inputNumber("8")})},"8"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[14]||(e[14]=function(t){return c.inputNumber("9")})},"9"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[15]||(e[15]=function(t){return c.inputPrefix("F")})},"F"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[16]||(e[16]=function(t){return c.inputPrefix("小")})},"小"),Object(o["h"])("button",{class:"btn keyboard-btn other",onClick:e[17]||(e[17]=function(t){return c.showMoreArea()})},"其他"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[18]||(e[18]=function(t){return c.inputNumber("0")})},"0"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[19]||(e[19]=function(t){return c.clearInput()})},"清除"),Object(o["h"])("div",Zt,[Object(o["h"])("button",{class:"btn keyboard-btn other",onClick:e[20]||(e[20]=function(t){return c.showMoreArea()})},"返回"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[21]||(e[21]=function(t){return c.inputPrefix("幹線")})},"幹線"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[22]||(e[22]=function(t){return c.inputPrefix("跳蛙")})},"跳蛙"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[23]||(e[23]=function(t){return c.inputPrefix("南軟")})},"南軟"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[24]||(e[24]=function(t){return c.inputPrefix("內科")})},"內科"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[25]||(e[25]=function(t){return c.inputPrefix("市民")})},"市民"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[26]||(e[26]=function(t){return c.inputPrefix("花季")})},"花季"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[27]||(e[27]=function(t){return c.inputPrefix("貓空")})},"貓空")])])):"Tainan"===n.city?(Object(o["w"])(),Object(o["g"])("div",Ft,[Object(o["h"])("button",{class:"btn keyboard-btn red",onClick:e[28]||(e[28]=function(t){return c.inputPrefix("紅")})},"紅"),Object(o["h"])("button",{class:"btn keyboard-btn blue",onClick:e[29]||(e[29]=function(t){return c.inputPrefix("藍")})},"藍"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[30]||(e[30]=function(t){return c.inputNumber("1")})},"1"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[31]||(e[31]=function(t){return c.inputNumber("2")})},"2"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[32]||(e[32]=function(t){return c.inputNumber("3")})},"3"),Object(o["h"])("button",{class:"btn keyboard-btn green",onClick:e[33]||(e[33]=function(t){return c.inputPrefix("綠")})},"綠"),Object(o["h"])("button",{class:"btn keyboard-btn brown",onClick:e[34]||(e[34]=function(t){return c.inputPrefix("棕")})},"棕"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[35]||(e[35]=function(t){return c.inputNumber("4")})},"4"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[36]||(e[36]=function(t){return c.inputNumber("5")})},"5"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[37]||(e[37]=function(t){return c.inputNumber("6")})},"6"),Object(o["h"])("button",{class:"btn keyboard-btn orange",onClick:e[38]||(e[38]=function(t){return c.inputPrefix("橘")})},"橘"),Object(o["h"])("button",{class:"btn keyboard-btn yellow",onClick:e[39]||(e[39]=function(t){return c.inputPrefix("黃")})},"黃"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[40]||(e[40]=function(t){return c.inputNumber("7")})},"7"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[41]||(e[41]=function(t){return c.inputNumber("8")})},"8"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[42]||(e[42]=function(t){return c.inputNumber("9")})},"9"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[43]||(e[43]=function(t){return c.inputPrefix("H")})},"H"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[44]||(e[44]=function(t){return c.inputPrefix("雙層")})},"雙層"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[45]||(e[45]=function(t){return c.inputPrefix("幹線")})},"幹線"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[46]||(e[46]=function(t){return c.inputNumber("0")})},"0"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[47]||(e[47]=function(t){return c.clearInput()})},"清除")])):"Kaohsiung"===n.city?(Object(o["w"])(),Object(o["g"])("div",Ht,[Object(o["h"])("button",{class:"btn keyboard-btn red",onClick:e[48]||(e[48]=function(t){return c.inputPrefix("紅")})},"紅"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[49]||(e[49]=function(t){return c.inputPrefix("JOY")})},"JOY"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[50]||(e[50]=function(t){return c.inputNumber("1")})},"1"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[51]||(e[51]=function(t){return c.inputNumber("2")})},"2"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[52]||(e[52]=function(t){return c.inputNumber("3")})},"3"),Object(o["h"])("button",{class:"btn keyboard-btn orange",onClick:e[53]||(e[53]=function(t){return c.inputPrefix("橘")})},"橘"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[54]||(e[54]=function(t){return c.inputPrefix("幹線")})},"幹線"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[55]||(e[55]=function(t){return c.inputNumber("4")})},"4"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[56]||(e[56]=function(t){return c.inputNumber("5")})},"5"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[57]||(e[57]=function(t){return c.inputNumber("6")})},"6"),Object(o["h"])("button",{class:"btn keyboard-btn yellow",onClick:e[58]||(e[58]=function(t){return c.inputPrefix("黃")})},"黃"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[59]||(e[59]=function(t){return c.inputPrefix("觀光")})},"觀光"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[60]||(e[60]=function(t){return c.inputNumber("7")})},"7"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[61]||(e[61]=function(t){return c.inputNumber("8")})},"8"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[62]||(e[62]=function(t){return c.inputNumber("9")})},"9"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[63]||(e[63]=function(t){return c.inputPrefix("T")})},"T"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[64]||(e[64]=function(t){return c.inputPrefix("E")})},"E"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[65]||(e[65]=function(t){return c.showMoreArea()})},"其他"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[66]||(e[66]=function(t){return c.inputNumber("0")})},"0"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[67]||(e[67]=function(t){return c.clearInput()})},"清除"),Object(o["h"])("div",Vt,[Object(o["h"])("button",{class:"btn keyboard-btn other",onClick:e[68]||(e[68]=function(t){return c.showMoreArea()})},"返回"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[69]||(e[69]=function(t){return c.inputPrefix("大湖")})},"大湖"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[70]||(e[70]=function(t){return c.inputPrefix("燕巢")})},"燕巢"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[71]||(e[71]=function(t){return c.inputPrefix("永安")})},"永安"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[72]||(e[72]=function(t){return c.inputPrefix("鼓山")})},"鼓山"),Object(o["h"])("button",{class:"btn keyboard-btn secondary",onClick:e[73]||(e[73]=function(t){return c.inputPrefix("大寮")})},"大寮")])])):(Object(o["w"])(),Object(o["g"])("div",Yt,[Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[74]||(e[74]=function(t){return c.inputNumber("1")})},"1"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[75]||(e[75]=function(t){return c.inputNumber("2")})},"2"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[76]||(e[76]=function(t){return c.inputNumber("3")})},"3"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[77]||(e[77]=function(t){return c.inputNumber("4")})},"4"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[78]||(e[78]=function(t){return c.inputNumber("5")})},"5"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[79]||(e[79]=function(t){return c.inputNumber("6")})},"6"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[80]||(e[80]=function(t){return c.inputNumber("7")})},"7"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[81]||(e[81]=function(t){return c.inputNumber("8")})},"8"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[82]||(e[82]=function(t){return c.inputNumber("9")})},"9"),"Taichung"===n.city?(Object(o["w"])(),Object(o["g"])("button",{key:0,class:"btn keyboard-btn other",onClick:e[83]||(e[83]=function(t){return c.inputPrefix("專用道")})},"專用道")):(Object(o["w"])(),Object(o["g"])("button",{key:1,class:"btn keyboard-btn other",onClick:e[84]||(e[84]=function(t){return c.inputPrefix("L")})},"L")),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[85]||(e[85]=function(t){return c.inputNumber("0")})},"0"),Object(o["h"])("button",{class:"btn keyboard-btn",onClick:e[86]||(e[86]=function(t){return c.clearInput()})},"清除")]))])}var Qt={name:"keyboard",props:["city"],data:function(){return{currentStr:""}},methods:{inputNumber:function(t){this.currentStr+=t},inputPrefix:function(t){this.currentStr="",this.currentStr+=t},clearInput:function(){this.currentStr=""},showMoreArea:function(){document.querySelector(".keyboard-moreArea").classList.toggle("active")}},watch:{currentStr:function(){this.$emit("emit-input",this.currentStr)}},mounted:function(){console.log(this.city)},created:function(){}},te=n("6b0d"),ee=n.n(te);const ne=ee()(Qt,[["render",Xt]]);var oe=ne,ie={},re=new qt.a.Icon({iconUrl:n("529f"),iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]}),ce=new qt.a.Icon({iconUrl:n("0168"),iconSize:[28,28],iconAnchor:[14,14],popupAnchor:[0,-14]}),se=new qt.a.Icon({iconUrl:n("fc97"),iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),ae=new qt.a.Icon({iconUrl:n("e275"),iconSize:[49,49],iconAnchor:[24,24],popupAnchor:[0,-24]}),ue={components:{SearchKeyboard:oe},data:function(){return{city:"",routeList:[],routeKeyword:"",stopOfRouteTo:[],stopOfRouteBack:[],selectRoute:"",selectRouteUID:"",selectLatlon:[],toOrBack:"to",routeGeometry:[],routeLayer:null,locationMarkerID:"",walkBusMarker:[],stopMarker:[],mobileTool:"route",timer:null,refreshTime:0,buslikes:[],buslikesId:[],prevRoute:null}},methods:{updateInput:function(t){this.routeKeyword=t},getRoute:function(){var t=this,e="";e="Taichung"===this.city&&"專用道"===this.routeKeyword?"https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/Taichung?$filter=RouteName%2FZh_tw%20in%20(%22300%22%2C%22301%22%2C%22302%22%2C%22303%22%2C%22304%22%2C%22305%22%2C%22306%22%2C%22307%22%2C%22308%22%2C%22309%22%2C%22310%22)&$format=JSON":"https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/".concat(this.city,"/").concat(this.routeKeyword,"?$top=50&$format=JSON"),this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){t.routeList=e.data})).catch((function(t){console.log(t)}))},toRouteDetailClick:function(t){"SPAN"!==event.target.tagName&&(this.toRouteDetail(t.RouteName.Zh_tw,t.RouteUID),this.fitBounds())},toRouteDetail:function(t,e){document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"),this.selectRoute=t,this.selectRouteUID=e,this.mobileTool="time",this.getStopOfRoute()},backToRouteSeachList:function(){this.prevRoute?"nearStation"!==this.prevRoute.name&&"busSearch"!==this.prevRoute.name&&"likeBus"!==this.prevRoute.name&&"stopSearch"!==this.prevRoute.name?(document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")):this.$router.go(-1):(document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active"))},getStopOfRoute:function(){var t=this;this.timer&&clearInterval(this.timer),this.timeCountDown(21);var e="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/".concat(this.city,"?$filter=RouteUID%20eq%20'").concat(this.selectRouteUID,"'&$format=JSON");this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){e.data.forEach((function(e){0===e.Direction?t.stopOfRouteTo=e.Stops:1===e.Direction&&(t.stopOfRouteBack=e.Stops)})),t.getEstimateTime(t.selectRoute,t.selectRouteUID)})).catch((function(t){console.log(t)}))},getEstimateTime:function(t,e){var n=this,o="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20in%20('").concat(e,"')&$format=JSON");this.axios.get(o,{headers:this.$getAuthorizationHeader()}).then((function(o){o.data.forEach((function(t){0===t.Direction&&n.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)})),1===t.Direction&&n.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)}))})),n.getPlateNum(t,e)})).catch((function(t){console.log(t)}))},getPlateNum:function(t,e){var n=this,o="https://ptx.transportdata.tw/MOTC/v2/Bus/RealTimeNearStop/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(o,{headers:this.$getAuthorizationHeader()}).then((function(o){o.data.forEach((function(t){0===t.Direction&&n.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)})),1===t.Direction&&n.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)}))})),n.getRouteGeometry(t,e)})).catch((function(t){console.log(t)}))},getRouteGeometry:function(t,e){var n=this,o="https://ptx.transportdata.tw/MOTC/v2/Bus/Shape/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(o,{headers:this.$getAuthorizationHeader()}).then((function(t){n.routeGeometry=t.data,ie.eachLayer((function(t){t._leaflet_id!==n.locationMarkerID&&(t instanceof qt.a.Marker&&ie.removeLayer(t),t instanceof qt.a.Popup&&ie.removeLayer(t),t.toGeoJSON&&ie.removeLayer(t))})),n.addRouteLayer()})).catch((function(t){console.log(t)}))},addRouteLayer:function(){var t=this,e={color:"#345E8A",weight:4},n=null;this.routeGeometry.forEach((function(o){var i=new Gt.a.Wkt;i.read(o.Geometry);var r=i.toJson();try{n=qt.a.geoJSON(r,{style:e}).addTo(ie),n.addData(r),t.routeLayer=n,t.addRouteMarker()}catch(c){console.log(c)}}))},changeToOrBack:function(t){this.toOrBack=t,this.addRouteMarker()},addRouteMarker:function(){var t=this,e=[];e="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),ie.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof qt.a.Marker&&ie.removeLayer(e),e instanceof qt.a.Popup&&ie.removeLayer(e))}));var n=ie.getZoom();n>15?this.zoomLevelAddMarker():e.forEach((function(t,n){if(t.PlateNumb){var o=qt.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:re});o.addTo(ie)}else if(0===n||n===e.length-1){var i=qt.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:se});i.addTo(ie)}}))},zoomLevelAddMarker:function(){var t=this;if(this.stopOfRouteTo.length>0&&this.stopOfRouteBack.length>0){var e=ie.getZoom();if(e<=15)this.addRouteMarker();else{var n=[];n="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),ie.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof qt.a.Marker&&ie.removeLayer(e),e instanceof qt.a.Popup&&ie.removeLayer(e))})),n.forEach((function(e,n){var o=t.createPopupContent(e),i=qt.a.popup({autoPan:!1,className:o.status,offset:[0,-12]});if(i.setLatLng(qt.a.latLng(e.StopPosition.PositionLat,e.StopPosition.PositionLon)),i.setContent(o.str),ie.addLayer(i),"popupWarning"===o.status){var r=qt.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:ce}).bindPopup(i);r.addTo(ie)}else{var c=qt.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:se}).bindPopup(i);c.addTo(ie)}}))}}},createPopupContent:function(t){var e="",o="popupPrimary";0===t.StopStatus?t.EstimateTime<=180&&t.PlateNumb?(e="進站中",o="popupWarning"):t.EstimateTime<=180?(e="即將進站",o="popupWarning"):e=this.$filters.toMinute(t.EstimateTime)+" 分":1===t.StopStatus?(e="尚未發車",o="popupSecondary"):2===t.StopStatus?(e="交管不停靠",o="popupSecondary"):3===t.StopStatus&&(e="末班車已過",o="popupSecondary");var i=n("464a"),r=t.PlateNumb?'<img src="'.concat(i,'" height="25" alt="icon">'):"",c='\n      <div class="stop-popup">\n        '.concat(r,'\n        <div class="name">').concat(t.StopName.Zh_tw,'</div>\n        <div class="time">').concat(e," </div>\n      </div>\n      ");return{str:c,status:o}},panToPosition:function(t,e){ie.setView([t,e],18),this.selectLatlon=[t,e],window.innerWidth<768&&this.showArea("map")},locateGPS:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){ie.eachLayer((function(e){e._leaflet_id===t.locationMarkerID&&ie.removeLayer(e)}));var n=[e.coords.latitude,e.coords.longitude];ie.setView(n,15),document.querySelector(".gps-icon").classList.add("active");var o=qt.a.marker([e.coords.latitude,e.coords.longitude],{icon:ae});o.addTo(ie),t.locationMarkerID=o._leaflet_id}))},showArea:function(t){"map"===t?(this.mobileTool="map",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.remove("active")):"route"===t?(this.mobileTool="route",document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")):"time"===t&&(this.mobileTool="time",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"))},getParam:function(){var t=""+this.$route.params.queryString,e=JSON.parse(decodeURIComponent(t));this.city=e.city,e.route&&e.routeUID&&(this.selectRoute=e.route,this.selectRouteUID=e.routeUID,this.toOrBack=0===e.direction?"to":"back",this.toRouteDetail(this.selectRoute,this.selectRouteUID),e.LatLon.length>0?this.panToPosition(e.LatLon[0],e.LatLon[1]):this.fitBounds())},fitBounds:function(){var t=this;setTimeout((function(){console.log("setTimeOut"),ie.fitBounds(t.routeLayer.getBounds())}),500)},timeCountDown:function(t){var e=this,n=t;this.timer=setInterval((function(){n>0?(n--,e.refreshTime=n):(clearInterval(e.timer),e.getStopOfRoute())}),1e3)},getLikes:function(){var t=localStorage.getItem("busLikes")?localStorage.getItem("busLikes"):"[]";this.buslikes=JSON.parse(t),this.buslikesId=this.buslikes.map((function(t){return t.routeUID}))},updateLikes_:function(t,e,n,o,i){var r={data:{data:{},message:"收藏",success:!0}};this.buslikesId.includes(e)?(this.buslikes.splice(this.buslikes.map((function(t){return t.routeUID})).indexOf(e),1),this.buslikesId.splice(this.buslikesId.indexOf(e),1),this.$httpMessageState(r,"移除收藏")):(this.buslikes.push({routeUID:e,routeName:t,start:n,end:o,city:i}),this.buslikesId.push(e),this.$httpMessageState(r,"加入收藏"))},updateLikes:function(t){var e={data:{data:{},message:"收藏",success:!0}};this.buslikesId.includes(t.RouteUID)?(this.buslikes.splice(this.buslikes.map((function(t){return t.routeUID})).indexOf(t.RouteUID),1),this.buslikesId.splice(this.buslikesId.indexOf(t.RouteUID),1),this.$httpMessageState(e,"移除收藏")):(this.buslikes.push({routeUID:t.RouteUID,routeName:t.RouteName.Zh_tw,start:t.DepartureStopNameZh,end:t.DestinationStopNameZh,city:this.city}),this.buslikesId.push(t.RouteUID),this.$httpMessageState(e,"加入收藏"))},saveLocalStorage:function(t){var e=JSON.stringify(t);try{localStorage.setItem("busLikes",e)}catch(n){return!1}},shareLink:function(){var t="";t+=document.URL.split("#")[0];var e={city:this.city,route:this.selectRoute,routeUID:this.selectRouteUID,direction:"to"===this.toOrBack?0:1,LatLon:this.selectLatlon},n=encodeURIComponent(JSON.stringify(e));t+="#/BusSearch/"+n;var o=document.createElement("input");document.body.appendChild(o),o.value=t,o.select(),o.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(o);var i={data:{data:{},message:"分享連結",success:!0}};this.$httpMessageState(i,"複製分享連結")}},watch:{routeKeyword:function(){this.getRoute()},buslikes:{handler:function(t,e){this.saveLocalStorage(this.buslikes)},deep:!0}},beforeRouteEnter:function(t,e,n){n((function(t){t.prevRoute=e}))},mounted:function(){ie=qt.a.map("map",{zoomControl:!1,center:[23.51357237187571,120.21110434230025],zoom:8,tap:!1}),qt.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(ie),qt.a.control.zoom({position:"bottomright"}).addTo(ie),ie.on("moveend",(function(){document.querySelector(".gps-icon").classList.remove("active")}));var t=this.zoomLevelAddMarker;ie.on("zoomend",(function(){t()})),this.getParam(),this.getLikes()},unmounted:function(){this.timer&&clearInterval(this.timer)}};const be=ee()(ue,[["render",_t]]);e["default"]=be},9263:function(t,e,n){"use strict";var o=n("c65b"),i=n("e330"),r=n("577e"),c=n("ad6d"),s=n("9f7f"),a=n("5692"),u=n("7c73"),b=n("69f3").get,l=n("fce3"),p=n("107c"),h=a("native-string-replace",String.prototype.replace),f=RegExp.prototype.exec,d=f,y=i("".charAt),m=i("".indexOf),O=i("".replace),k=i("".slice),g=function(){var t=/a/,e=/b*/g;return o(f,t,"a"),o(f,e,"a"),0!==t.lastIndex||0!==e.lastIndex}(),j=s.UNSUPPORTED_Y||s.BROKEN_CARET,v=void 0!==/()??/.exec("")[1],x=g||v||j||l||p;x&&(d=function(t){var e,n,i,s,a,l,p,x=this,S=b(x),C=r(t),w=S.raw;if(w)return w.lastIndex=x.lastIndex,e=o(d,w,C),x.lastIndex=w.lastIndex,e;var P=S.groups,R=j&&x.sticky,N=o(c,x),I=x.source,T=0,L=C;if(R&&(N=O(N,"y",""),-1===m(N,"g")&&(N+="g"),L=k(C,x.lastIndex),x.lastIndex>0&&(!x.multiline||x.multiline&&"\n"!==y(C,x.lastIndex-1))&&(I="(?: "+I+")",L=" "+L,T++),n=new RegExp("^(?:"+I+")",N)),v&&(n=new RegExp("^"+I+"$(?!\\s)",N)),g&&(i=x.lastIndex),s=o(f,R?n:x,L),R?s?(s.input=k(s.input,T),s[0]=k(s[0],T),s.index=x.lastIndex,x.lastIndex+=s[0].length):x.lastIndex=0:g&&s&&(x.lastIndex=x.global?s.index+s[0].length:i),v&&s&&s.length>1&&o(h,s[0],n,(function(){for(a=1;a<arguments.length-2;a++)void 0===arguments[a]&&(s[a]=void 0)})),s&&P)for(s.groups=l=u(null),a=0;a<P.length;a++)p=P[a],l[p[0]]=s[p[1]];return s}),t.exports=d},"99af":function(t,e,n){"use strict";var o=n("23e7"),i=n("da84"),r=n("d039"),c=n("e8b5"),s=n("861d"),a=n("7b0b"),u=n("07fa"),b=n("8418"),l=n("65f0"),p=n("1dde"),h=n("b622"),f=n("2d00"),d=h("isConcatSpreadable"),y=9007199254740991,m="Maximum allowed index exceeded",O=i.TypeError,k=f>=51||!r((function(){var t=[];return t[d]=!1,t.concat()[0]!==t})),g=p("concat"),j=function(t){if(!s(t))return!1;var e=t[d];return void 0!==e?!!e:c(t)},v=!k||!g;o({target:"Array",proto:!0,forced:v},{concat:function(t){var e,n,o,i,r,c=a(this),s=l(c,0),p=0;for(e=-1,o=arguments.length;e<o;e++)if(r=-1===e?c:arguments[e],j(r)){if(i=u(r),p+i>y)throw O(m);for(n=0;n<i;n++,p++)n in r&&b(s,p,r[n])}else{if(p>=y)throw O(m);b(s,p++,r)}return s.length=p,s}})},"9f7f":function(t,e,n){var o=n("d039"),i=n("da84"),r=i.RegExp;e.UNSUPPORTED_Y=o((function(){var t=r("a","y");return t.lastIndex=2,null!=t.exec("abcd")})),e.BROKEN_CARET=o((function(){var t=r("^r","gy");return t.lastIndex=2,null!=t.exec("str")}))},ac1f:function(t,e,n){"use strict";var o=n("23e7"),i=n("9263");o({target:"RegExp",proto:!0,forced:/./.exec!==i},{exec:i})},ad6d:function(t,e,n){"use strict";var o=n("825a");t.exports=function(){var t=o(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},b0c0:function(t,e,n){var o=n("83ab"),i=n("5e77").EXISTS,r=n("e330"),c=n("9bf2").f,s=Function.prototype,a=r(s.toString),u=/^\s*function ([^ (]*)/,b=r(u.exec),l="name";o&&!i&&c(s,l,{configurable:!0,get:function(){try{return b(u,a(this))[1]}catch(t){return""}}})},d784:function(t,e,n){"use strict";n("ac1f");var o=n("e330"),i=n("6eeb"),r=n("9263"),c=n("d039"),s=n("b622"),a=n("9112"),u=s("species"),b=RegExp.prototype;t.exports=function(t,e,n,l){var p=s(t),h=!c((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),f=h&&!c((function(){var e=!1,n=/a/;return"split"===t&&(n={},n.constructor={},n.constructor[u]=function(){return n},n.flags="",n[p]=/./[p]),n.exec=function(){return e=!0,null},n[p](""),!e}));if(!h||!f||n){var d=o(/./[p]),y=e(p,""[t],(function(t,e,n,i,c){var s=o(t),a=e.exec;return a===r||a===b.exec?h&&!c?{done:!0,value:d(e,n,i)}:{done:!0,value:s(n,e,i)}:{done:!1}}));i(String.prototype,t,y[0]),i(b,p,y[1])}l&&a(b[p],"sham",!0)}},fc97:function(t,e,n){t.exports=n.p+"img/busStop.2fb86a4d.svg"},fce3:function(t,e,n){var o=n("d039"),i=n("da84"),r=i.RegExp;t.exports=o((function(){var t=r(".","s");return!(t.dotAll&&t.exec("\n")&&"s"===t.flags)}))}}]);
//# sourceMappingURL=chunk-1715fe2a.2f0f154e.js.map