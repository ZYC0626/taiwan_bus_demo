{"version":3,"sources":["webpack:///./src/views/StopSearch.vue","webpack:///./src/views/StopSearch.vue?087a"],"names":["class","list","id","placeholder","src","alt","active","isLoading","z-index","city","getAllStationFromCity","cityList","value","City","key","CityName","optiondata","option","StationName","Zh_tw","StationUID","locateGPS","openStreetMap","positionIcon","Icon","iconUrl","iconSize","iconAnchor","popupAnchor","data","locationMarkerID","methods","navigator","geolocation","getCurrentPosition","position","eachLayer","layer","_leaflet_id","removeLayer","locate","coords","latitude","longitude","console","log","setView","document","querySelector","classList","add","marker","icon","addTo","this","url","axios","get","headers","$getAuthorizationHeader","then","response","catch","err","mounted","map","zoomControl","center","zoom","tap","tileLayer","attribution","control","on","remove","__exports__","render"],"mappings":"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","file":"js/chunk-2d224941.fa5eb5e9.js","sourcesContent":["<template>\r\n  <Loading :active=\"isLoading\"\r\n  :z-index=\"2000\">\r\n  </Loading>\r\n  <div class=\"h-100 d-flex flex-column\">\r\n    <div class=\"bread-bar\">\r\n      <ol class=\"breadcrumb m-0 d-md-flex d-none\">\r\n        <li class=\"breadcrumb-item\"><a href=\"#\">首頁</a></li>\r\n        <li class=\"breadcrumb-item active\" aria-current=\"page\">附近站牌</li>\r\n      </ol>\r\n    </div>\r\n    <div class=\"map-wrap\">\r\n      <div class=\"route-search-area active\">\r\n        <div class=\"route-search-header\">\r\n          <select class=\"form-select mb-2\" v-model=\"city\"\r\n          @change=\"getAllStationFromCity()\">\r\n            <option :value=\"city.City\" v-for=\"city in cityList\" :key=\"city.City\">{{ city.CityName }}</option>\r\n          </select>\r\n          <input list=\"datalistOptions\" class=\"form-control\" id=\"stationName\" placeholder=\"想去哪裡?\">\r\n          <datalist id=\"datalistOptions\">\r\n            <option :value=\"option.StationName.Zh_tw\" v-for=\"option in optiondata\" :key=\"option.StationUID\"></option>\r\n          </datalist>\r\n        </div>\r\n        <div class=\"route-search-body\">\r\n          <ul class=\"route-list\">\r\n            <!-- <li class=\"route-list-item\" v-for=\"item in routeList\" :key=\"item.RouteUID\">\r\n              <div class=\"d-flex justify-content-between\">\r\n                <div class=\"title\">{{ item.RouteName.Zh_tw }}</div>\r\n                <div class=\"icon\">\r\n                  <a href=\"#\"><span class=\"material-icons\">\r\n                  favorite_border\r\n                  </span></a>\r\n                </div>\r\n              </div>\r\n              <div class=\"d-flex justify-content-between\">\r\n                <div class=\"od\">{{ item.DepartureStopNameZh }}-{{ item.DestinationStopNameZh }}</div>\r\n                <div class=\"city\">{{ city }}</div>\r\n              </div>\r\n            </li> -->\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div class=\"gps-icon\" @click=\"locateGPS()\">\r\n        <img src=\"@/assets/images/gps.svg\" class=\"icon-filter\" alt=\"gps-icon\">\r\n      </div>\r\n      <div class=\"map\" id=\"map\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport $L from 'leaflet'\r\nimport cityList from '@/assets/CityList.json'\r\n// import Wkt from 'wicket'\r\nlet openStreetMap = {}\r\n\r\n// const stationIcon = new $L.Icon({\r\n//   iconUrl: require('@/assets/images/busStop.svg'),\r\n//   iconSize: [24, 24],\r\n//   iconAnchor: [12, 12],\r\n//   popupAnchor: [0, -12]\r\n// })\r\nconst positionIcon = new $L.Icon({\r\n  iconUrl: require('@/assets/images/position.svg'),\r\n  iconSize: [49, 49],\r\n  iconAnchor: [24, 24],\r\n  popupAnchor: [0, -24]\r\n})\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      isLoading: false,\r\n      locationMarkerID: '',\r\n      optiondata: [],\r\n      city: 'Taipei',\r\n      cityList\r\n    }\r\n  },\r\n  methods: {\r\n    locateGPS () {\r\n      // 定位\r\n      navigator.geolocation.getCurrentPosition(position => {\r\n        openStreetMap.eachLayer((layer) => {\r\n          if (layer._leaflet_id === this.locationMarkerID) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n        })\r\n        const locate = [position.coords.latitude, position.coords.longitude]\r\n        console.log(locate)\r\n        openStreetMap.setView(locate, 15)\r\n        document.querySelector('.gps-icon').classList.add('active')\r\n        const marker = $L.marker([position.coords.latitude, position.coords.longitude], { icon: positionIcon })\r\n        marker.addTo(openStreetMap)\r\n        this.locationMarkerID = marker._leaflet_id\r\n      })\r\n    },\r\n    getAllStationFromCity () {\r\n      this.isLoading = true\r\n      const url = `https://ptx.transportdata.tw/MOTC/v2/Bus/Station/City/${this.city}?$select=StationUID%2CStationID%2CStationName%2CStationPosition%2CStationAddress&$format=JSON`\r\n      this.axios.get(url,\r\n        {\r\n          headers: this.$getAuthorizationHeader()\r\n        }\r\n      )\r\n        .then((response) => {\r\n          console.log(response.data)\r\n          this.optiondata = response.data\r\n          this.isLoading = false\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    }\r\n  },\r\n  mounted () {\r\n    // quick start\r\n    openStreetMap = $L.map('map', {\r\n      zoomControl: false,\r\n      center: [25.0834397, 121.4570441],\r\n      zoom: 13,\r\n      tap: false\r\n    })\r\n    $L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution:\r\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n    }).addTo(openStreetMap)\r\n\r\n    // resset zoom position\r\n    $L.control.zoom({\r\n      position: 'bottomright'\r\n    }).addTo(openStreetMap)\r\n    openStreetMap.on('moveend', function () {\r\n      document.querySelector('.gps-icon').classList.remove('active')\r\n    })\r\n    this.locateGPS()\r\n    this.getAllStationFromCity()\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./StopSearch.vue?vue&type=template&id=752686db\"\nimport script from \"./StopSearch.vue?vue&type=script&lang=js\"\nexport * from \"./StopSearch.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Desktop\\\\F2E\\\\bus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}