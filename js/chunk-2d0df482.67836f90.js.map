{"version":3,"sources":["webpack:///./src/views/LikeBus.vue","webpack:///./src/views/LikeBus.vue?f896"],"names":["class","style","src","alt","id","active","isLoading","z-index","buslikes","length","item","key","routeUID","toRouteDetail","routeName","href","updateLikes","buslikesId","includes","start","end","$filters","replaceCity","city","locateGPS","openStreetMap","positionIcon","Icon","iconUrl","iconSize","iconAnchor","popupAnchor","data","locationMarkerID","cityList","methods","navigator","geolocation","getCurrentPosition","position","eachLayer","layer","_leaflet_id","removeLayer","locate","coords","latitude","longitude","console","log","setView","document","querySelector","classList","add","marker","icon","addTo","getLikes","likeStr","localStorage","getItem","this","JSON","parse","map","x","res","message","success","splice","indexOf","$httpMessageState","push","saveLocalStorage","datastr","stringify","setItem","e","event","target","tagName","param","route","direction","LatLon","qStr","$router","watch","handler","n","o","deep","mounted","zoomControl","center","zoom","tap","tileLayer","attribution","control","on","remove","__exports__","render"],"mappings":"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","file":"js/chunk-2d0df482.67836f90.js","sourcesContent":["<template>\r\n  <Loading :active=\"isLoading\"\r\n  :z-index=\"2000\">\r\n  </Loading>\r\n  <div class=\"h-100 d-flex flex-column\">\r\n    <div class=\"bread-bar\">\r\n      <ol class=\"breadcrumb m-0\">\r\n        <li class=\"breadcrumb-item\"><a href=\"#\">首頁</a></li>\r\n        <li class=\"breadcrumb-item active\" aria-current=\"page\">收藏站牌</li>\r\n      </ol>\r\n    </div>\r\n    <div class=\"map-wrap\">\r\n      <div class=\"route-search-area active\">\r\n        <div class=\"route-search-header\">\r\n          <!-- <input type=\"search\" class=\"form-control\" id=\"stationName\" placeholder=\"想去哪裡?\"> -->\r\n          <h4 class=\"fw-700 ms-1 mb-0\">收藏站牌</h4>\r\n        </div>\r\n        <div class=\"route-search-body\">\r\n          <ul class=\"route-list\" v-if=\"buslikes.length > 0\">\r\n            <li class=\"route-list-item\" v-for=\"item in buslikes\" :key=\"item.routeUID\"\r\n            @click=\"toRouteDetail(item)\">\r\n              <div class=\"d-flex justify-content-between\">\r\n                <div class=\"title\">{{ item.routeName }}</div>\r\n                <div class=\"icon\">\r\n                  <a href=\"#\"\r\n                  @click.prevent=\"updateLikes(item)\">\r\n                  <span class=\"material-icons love\" v-if=\"buslikesId.includes(item.routeUID)\">\r\n                    favorite\r\n                  </span>\r\n                  <span class=\"material-icons\" v-else>\r\n                    favorite_border\r\n                  </span>\r\n                  </a>\r\n                </div>\r\n              </div>\r\n              <div class=\"d-flex justify-content-between\">\r\n                <div class=\"od\">{{ item.start }}-{{ item.end }}</div>\r\n                <div class=\"city\">{{ $filters.replaceCity(item.city) }}</div>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n          <h5 class=\"fw-700 text-center\" style=\"font-size: 18px; color:#888888;\" v-else>目前還沒有收藏的站牌!<br>\r\n          快用<span class=\"material-icons mx-2\" style=\"font-size: 18px; color:#888888;\">favorite_border</span>來收藏站牌吧</h5>\r\n        </div>\r\n      </div>\r\n      <div class=\"gps-icon\" @click=\"locateGPS()\">\r\n        <img src=\"@/assets/images/gps.svg\" class=\"icon-filter\" alt=\"gps-icon\">\r\n      </div>\r\n      <div class=\"map\" id=\"map\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport $L from 'leaflet'\r\nimport cityList from '@/assets/CityList.json'\r\n// import Wkt from 'wicket'\r\nlet openStreetMap = {}\r\n\r\n// const stationIcon = new $L.Icon({\r\n//   iconUrl: require('@/assets/images/busStop.svg'),\r\n//   iconSize: [24, 24],\r\n//   iconAnchor: [12, 12],\r\n//   popupAnchor: [0, -12]\r\n// })\r\nconst positionIcon = new $L.Icon({\r\n  iconUrl: require('@/assets/images/position.svg'),\r\n  iconSize: [49, 49],\r\n  iconAnchor: [24, 24],\r\n  popupAnchor: [0, -24]\r\n})\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      isLoading: false,\r\n      locationMarkerID: '',\r\n      buslikes: [],\r\n      buslikesId: [],\r\n      cityList\r\n    }\r\n  },\r\n  methods: {\r\n    locateGPS () {\r\n      // 定位\r\n      navigator.geolocation.getCurrentPosition(position => {\r\n        openStreetMap.eachLayer((layer) => {\r\n          if (layer._leaflet_id === this.locationMarkerID) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n        })\r\n        const locate = [position.coords.latitude, position.coords.longitude]\r\n        console.log(locate)\r\n        openStreetMap.setView(locate, 15)\r\n        document.querySelector('.gps-icon').classList.add('active')\r\n        const marker = $L.marker([position.coords.latitude, position.coords.longitude], { icon: positionIcon })\r\n        marker.addTo(openStreetMap)\r\n        this.locationMarkerID = marker._leaflet_id\r\n      })\r\n    },\r\n    getLikes () {\r\n      // console.log(localStorage.getItem('likelist'))\r\n      const likeStr = localStorage.getItem('busLikes') ? localStorage.getItem('busLikes') : '[]'\r\n      this.buslikes = JSON.parse(likeStr)\r\n      this.buslikesId = this.buslikes.map(x => { return x.routeUID })\r\n      console.log(this.buslikesId)\r\n    },\r\n    updateLikes (item) {\r\n      const res = {\r\n        data: {\r\n          data: {},\r\n          message: '收藏',\r\n          success: true\r\n        }\r\n      }\r\n      if (this.buslikesId.includes(item.routeUID)) {\r\n        this.buslikes.splice(this.buslikes.map(x => { return x.routeUID }).indexOf(item.routeUID), 1)\r\n        this.buslikesId.splice(this.buslikesId.indexOf(item.routeUID), 1)\r\n        this.$httpMessageState(res, '移除收藏')\r\n      } else {\r\n        this.buslikes.push({\r\n          routeUID: item.routeUID,\r\n          routeName: item.routeName,\r\n          start: item.start,\r\n          end: item.end,\r\n          city: item.city\r\n        })\r\n        this.buslikesId.push(item.routeUID)\r\n        this.$httpMessageState(res, '加入收藏')\r\n      }\r\n      // console.log(this.buslikes)\r\n    },\r\n    saveLocalStorage (data) {\r\n      const datastr = JSON.stringify(data)\r\n      try {\r\n        localStorage.setItem('busLikes', datastr)\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    },\r\n    toRouteDetail (item) {\r\n      if (event.target.tagName !== 'SPAN') {\r\n        console.log(item)\r\n        const param = {\r\n          city: item.city,\r\n          route: item.routeName,\r\n          routeUID: item.routeUID,\r\n          direction: 0,\r\n          LatLon: []\r\n        }\r\n        const qStr = JSON.stringify(param)\r\n        this.$router.push(`/BusSearch/${qStr}`)\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    buslikes: {\r\n      handler (n, o) {\r\n        this.saveLocalStorage(this.buslikes)\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted () {\r\n    // quick start\r\n    openStreetMap = $L.map('map', {\r\n      zoomControl: false,\r\n      center: [25.0834397, 121.4570441],\r\n      zoom: 13,\r\n      tap: false\r\n    })\r\n    $L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution:\r\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n    }).addTo(openStreetMap)\r\n\r\n    // resset zoom position\r\n    $L.control.zoom({\r\n      position: 'bottomright'\r\n    }).addTo(openStreetMap)\r\n    openStreetMap.on('moveend', function () {\r\n      document.querySelector('.gps-icon').classList.remove('active')\r\n    })\r\n    this.locateGPS()\r\n    this.getLikes()\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./LikeBus.vue?vue&type=template&id=9e5900ee\"\nimport script from \"./LikeBus.vue?vue&type=script&lang=js\"\nexport * from \"./LikeBus.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Desktop\\\\F2E\\\\bus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"sourceRoot":""}