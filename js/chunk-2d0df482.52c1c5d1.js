(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0df482"],{"88f2":function(e,t,s){"use strict";s.r(t);s("caad"),s("2532");var c=s("7a23"),i=s("42f0"),o=s.n(i),a={class:"h-100 d-flex flex-column"},r=Object(c["i"])('<div class="bread-bar"><ol class="breadcrumb m-0"><li class="breadcrumb-item"><a href="#">首頁</a></li><li class="breadcrumb-item active" aria-current="page">收藏站牌</li></ol></div>',1),n={class:"map-wrap"},l={class:"route-search-area active"},u=Object(c["h"])("div",{class:"route-search-header"},[Object(c["h"])("h4",{class:"fw-700 ms-1 mb-0"},"收藏站牌")],-1),d={class:"route-search-body"},b={key:0,class:"route-list"},h=["onClick"],p={class:"d-flex justify-content-between"},O={class:"title"},j={class:"icon"},f=["onClick"],g={key:0,class:"material-icons love"},m={key:1,class:"material-icons"},k={class:"d-flex justify-content-between"},v={class:"od"},y={class:"city"},I={key:1,class:"fw-700 text-center",style:{"font-size":"18px",color:"#888888"}},w=Object(c["j"])("目前還沒有收藏的站牌!"),L=Object(c["h"])("br",null,null,-1),S=Object(c["j"])(" 快用"),D=Object(c["h"])("span",{class:"material-icons mx-2",style:{"font-size":"18px",color:"#888888"}},"favorite_border",-1),U=Object(c["j"])("來收藏站牌吧"),x=[w,L,S,D,U],C=Object(c["h"])("img",{src:o.a,class:"icon-filter",alt:"gps-icon"},null,-1),N=[C],z=Object(c["h"])("div",{class:"map",id:"map"},null,-1);function G(e,t,s,i,o,w){var L=Object(c["D"])("Loading");return Object(c["w"])(),Object(c["g"])(c["a"],null,[Object(c["k"])(L,{active:o.isLoading,"z-index":2e3},null,8,["active"]),Object(c["h"])("div",a,[r,Object(c["h"])("div",n,[Object(c["h"])("div",l,[u,Object(c["h"])("div",d,[o.buslikes.length>0?(Object(c["w"])(),Object(c["g"])("ul",b,[(Object(c["w"])(!0),Object(c["g"])(c["a"],null,Object(c["B"])(o.buslikes,(function(t){return Object(c["w"])(),Object(c["g"])("li",{class:"route-list-item",key:t.routeUID,onClick:function(e){return w.toRouteDetail(t)}},[Object(c["h"])("div",p,[Object(c["h"])("div",O,Object(c["G"])(t.routeName),1),Object(c["h"])("div",j,[Object(c["h"])("a",{href:"#",onClick:Object(c["O"])((function(e){return w.updateLikes(t)}),["prevent"])},[o.buslikesId.includes(t.routeUID)?(Object(c["w"])(),Object(c["g"])("span",g," favorite ")):(Object(c["w"])(),Object(c["g"])("span",m," favorite_border "))],8,f)])]),Object(c["h"])("div",k,[Object(c["h"])("div",v,Object(c["G"])(t.start)+"-"+Object(c["G"])(t.end),1),Object(c["h"])("div",y,Object(c["G"])(e.$filters.replaceCity(t.city)),1)])],8,h)})),128))])):(Object(c["w"])(),Object(c["g"])("h5",I,x))])]),Object(c["h"])("div",{class:"gps-icon",onClick:t[0]||(t[0]=function(e){return w.locateGPS()})},N),z])])],64)}s("d81d"),s("a434"),s("e9c4");var M=s("e11e"),_=s.n(M),J=s("cc8c"),P={},$=new _.a.Icon({iconUrl:s("e275"),iconSize:[49,49],iconAnchor:[24,24],popupAnchor:[0,-24]}),A={data:function(){return{isLoading:!1,locationMarkerID:"",buslikes:[],buslikesId:[],cityList:J}},methods:{locateGPS:function(){var e=this;navigator.geolocation.getCurrentPosition((function(t){P.eachLayer((function(t){t._leaflet_id===e.locationMarkerID&&P.removeLayer(t)}));var s=[t.coords.latitude,t.coords.longitude];console.log(s),P.setView(s,15),document.querySelector(".gps-icon").classList.add("active");var c=_.a.marker([t.coords.latitude,t.coords.longitude],{icon:$});c.addTo(P),e.locationMarkerID=c._leaflet_id}))},getLikes:function(){var e=localStorage.getItem("busLikes")?localStorage.getItem("busLikes"):"[]";this.buslikes=JSON.parse(e),this.buslikesId=this.buslikes.map((function(e){return e.routeUID})),console.log(this.buslikesId)},updateLikes:function(e){var t={data:{data:{},message:"收藏",success:!0}};this.buslikesId.includes(e.routeUID)?(this.buslikes.splice(this.buslikes.map((function(e){return e.routeUID})).indexOf(e.routeUID),1),this.buslikesId.splice(this.buslikesId.indexOf(e.routeUID),1),this.$httpMessageState(t,"移除收藏")):(this.buslikes.push({routeUID:e.routeUID,routeName:e.routeName,start:e.start,end:e.end,city:e.city}),this.buslikesId.push(e.routeUID),this.$httpMessageState(t,"加入收藏"))},saveLocalStorage:function(e){var t=JSON.stringify(e);try{localStorage.setItem("busLikes",t)}catch(s){return!1}},toRouteDetail:function(e){if("SPAN"!==event.target.tagName){console.log(e);var t={city:e.city,route:e.routeName,routeUID:e.routeUID,direction:0,LatLon:[]},s=encodeURIComponent(JSON.stringify(t));this.$router.push("/BusSearch/".concat(s))}}},watch:{buslikes:{handler:function(e,t){this.saveLocalStorage(this.buslikes)},deep:!0}},mounted:function(){P=_.a.map("map",{zoomControl:!1,center:[25.0834397,121.4570441],zoom:13,tap:!1}),_.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(P),_.a.control.zoom({position:"bottomright"}).addTo(P),P.on("moveend",(function(){document.querySelector(".gps-icon").classList.remove("active")})),this.locateGPS(),this.getLikes()}},R=s("6b0d"),T=s.n(R);const q=T()(A,[["render",G]]);t["default"]=q}}]);
//# sourceMappingURL=chunk-2d0df482.52c1c5d1.js.map