(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8df0a5ee"],{"0168":function(t,e,o){t.exports=o.p+"img/busStop_in.bee2e2f7.svg"},11343:function(t,e,o){var i;
/** @license
 *
 *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
 *  Michigan Tech Research Institute (MTRI)
 *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */(function(s,n){i=function(){return n()}.call(e,o,e,t),void 0===i||(t.exports=i)})(0,(function(){var t,e,o;return this,o=function(t){return t instanceof o?t:this instanceof o?void(this._wrapped=t):new o(t)},t=function(t,e){return t.substring(0,e.length)===e},e=function(t,e){return t.substring(t.length-e.length)===e},o.delimiter=" ",o.isArray=function(t){return!(!t||t.constructor!==Array)},o.trim=function(o,i){i=i||" ";while(t(o,i))o=o.substring(1);while(e(o,i))o=o.substring(0,o.length-1);return o},o.Wkt=function(t){this.delimiter=o.delimiter||" ",this.wrapVertices=!0,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/},this._stripWhitespaceAndParens=function(t){var e=t.trim(),o=e.replace(/^\(?(.*?)\)?$/,"$1");return o},this.components=void 0,t&&"string"===typeof t?this.read(t):t&&void 0!==typeof t&&this.fromObject(t)},o.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case"multi":return!0;case"polyg":return!0;default:return!1}},o.Wkt.prototype.sameCoords=function(t,e){return t.x===e.x&&t.y===e.y},o.Wkt.prototype.fromObject=function(t){var e;return e=t.hasOwnProperty("type")&&t.hasOwnProperty("coordinates")?this.fromJson(t):this.deconstruct.call(this,t),this.components=e.components,this.isRectangle=e.isRectangle||!1,this.type=e.type,this},o.Wkt.prototype.toObject=function(t){var e=this.construct[this.type].call(this,t);return"object"!==typeof e||o.isArray(e)||(e.properties=this.properties),e},o.Wkt.prototype.toString=function(t){return this.write()},o.Wkt.prototype.fromJson=function(t){var e,i,s,n,r,a;if(this.type=t.type.toLowerCase(),this.components=[],t.hasOwnProperty("geometry"))return this.fromJson(t.geometry),this.properties=t.properties,this;if(n=t.coordinates,o.isArray(n[0])){for(e in n)if(n.hasOwnProperty(e))if(o.isArray(n[e][0])){for(i in a=[],n[e])if(n[e].hasOwnProperty(i))if(o.isArray(n[e][i][0])){for(s in r=[],n[e][i])n[e][i].hasOwnProperty(s)&&r.push({x:n[e][i][s][0],y:n[e][i][s][1]});a.push(r)}else a.push({x:n[e][i][0],y:n[e][i][1]});this.components.push(a)}else"multipoint"===this.type?this.components.push([{x:n[e][0],y:n[e][1]}]):this.components.push({x:n[e][0],y:n[e][1]})}else this.components.push({x:n[0],y:n[1]});return this},o.Wkt.prototype.toJson=function(){var t,e,i,s,n,r,a;if(t=this.components,e={coordinates:[],type:function(){var t,e,o;for(t in e=this.regExes.ogcTypes.exec(this.type).slice(1),o=[],e)e.hasOwnProperty(t)&&void 0!==e[t]&&o.push(e[t].toLowerCase().slice(0,1).toUpperCase()+e[t].toLowerCase().slice(1));return o}.call(this).join("")},"box"===this.type.toLowerCase()){for(i in e.type="Polygon",e.bbox=[],t)t.hasOwnProperty(i)&&(e.bbox=e.bbox.concat([t[i].x,t[i].y]));return e.coordinates=[[[t[0].x,t[0].y],[t[0].x,t[1].y],[t[1].x,t[1].y],[t[1].x,t[0].y],[t[0].x,t[0].y]]],e}for(i in t)if(t.hasOwnProperty(i))if(o.isArray(t[i])){for(s in a=[],t[i])if(t[i].hasOwnProperty(s))if(o.isArray(t[i][s])){for(n in r=[],t[i][s])t[i][s].hasOwnProperty(n)&&r.push([t[i][s][n].x,t[i][s][n].y]);a.push(r)}else t[i].length>1?a.push([t[i][s].x,t[i][s].y]):a=a.concat([t[i][s].x,t[i][s].y]);e.coordinates.push(a)}else t.length>1?e.coordinates.push([t[i].x,t[i].y]):e.coordinates=e.coordinates.concat([t[i].x,t[i].y]);return e},o.Wkt.prototype.merge=function(t){var e=this.type.slice(0,5);if(this.type!==t.type&&this.type.slice(5,this.type.length)!==t.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(e){case"point":this.components=[this.components.concat(t.components)];break;case"multi":this.components=this.components.concat("multi"===t.type.slice(0,5)?t.components:[t.components]);break;default:this.components=[this.components,t.components];break}return"multi"!==e&&(this.type="multi"+this.type),this},o.Wkt.prototype.read=function(t){var e;if(e=this.regExes.typeStr.exec(t),e)this.type=e[1].toLowerCase(),this.base=e[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else{if(!this.regExes.crudeJson.test(t))throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",message:"Invalid WKT string provided to read()"};if("object"!==typeof JSON||"function"!==typeof JSON.parse)throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};this.fromJson(JSON.parse(t))}return this},o.Wkt.prototype.write=function(t){var e,o,i;for(t=t||this.components,o=[],o.push(this.type.toUpperCase()+"("),e=0;e<t.length;e+=1){if(this.isCollection()&&e>0&&o.push(","),!this.extract[this.type])return null;i=this.extract[this.type].apply(this,[t[e]]),this.isCollection()&&"multipoint"!==this.type?o.push("("+i+")"):(o.push(i),e!==t.length-1&&"multipoint"!==this.type&&o.push(","))}return o.push(")"),o.join("")},o.Wkt.prototype.extract={point:function(t){return String(t.x)+this.delimiter+String(t.y)},multipoint:function(t){var e,o,i=[];for(e=0;e<t.length;e+=1)o=this.extract.point.apply(this,[t[e]]),this.wrapVertices&&(o="("+o+")"),i.push(o);return i.join(",")},linestring:function(t){return this.extract.point.apply(this,[t])},multilinestring:function(t){var e,o=[];if(t.length)for(e=0;e<t.length;e+=1)o.push(this.extract.linestring.apply(this,[t[e]]));else o.push(this.extract.point.apply(this,[t]));return o.join(",")},polygon:function(t){return this.extract.multilinestring.apply(this,[t])},multipolygon:function(t){var e,o=[];for(e=0;e<t.length;e+=1)o.push("("+this.extract.polygon.apply(this,[t[e]])+")");return o.join(",")},box:function(t){return this.extract.linestring.apply(this,[t])},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},o.Wkt.prototype.ingest={point:function(t){var e=o.trim(t).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(e[0])[0]),y:parseFloat(this.regExes.numeric.exec(e[1])[0])}]},multipoint:function(t){var e,i,s;for(i=[],s=o.trim(t).split(this.regExes.comma),e=0;e<s.length;e+=1)i.push(this.ingest.point.apply(this,[s[e]]));return i},linestring:function(t){var e,o,i;for(o=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<o.length;e+=1)i=i.concat(o[e]);return i},multilinestring:function(t){var e,i,s,n;for(i=[],n=o.trim(t).split(this.regExes.doubleParenComma),1===n.length&&(n=o.trim(t).split(this.regExes.parenComma)),e=0;e<n.length;e+=1)s=this._stripWhitespaceAndParens(n[e]),i.push(this.ingest.linestring.apply(this,[s]));return i},polygon:function(t){var e,i,s,n,r,a;for(a=o.trim(t).split(this.regExes.parenComma),s=[],e=0;e<a.length;e+=1){for(r=this._stripWhitespaceAndParens(a[e]).split(this.regExes.comma),n=[],i=0;i<r.length;i+=1){var c=r[i].split(this.regExes.spaces);if(c.length>2&&(c=c.filter((function(t){return""!=t}))),2===c.length){var u=c[0],l=c[1];n.push({x:parseFloat(u),y:parseFloat(l)})}}s.push(n)}return s},box:function(t){var e,o,i;for(o=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<o.length;e+=1)i=i.concat(o[e]);return i},multipolygon:function(t){var e,i,s,n;for(i=[],n=o.trim(t).split(this.regExes.doubleParenComma),e=0;e<n.length;e+=1)s=this._stripWhitespaceAndParens(n[e]),i.push(this.ingest.polygon.apply(this,[s]));return i},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},o}))},"159b":function(t,e,o){var i=o("da84"),s=o("fdbc"),n=o("785a"),r=o("17c2"),a=o("9112"),c=function(t){if(t&&t.forEach!==r)try{a(t,"forEach",r)}catch(e){t.forEach=r}};for(var u in s)s[u]&&c(i[u]&&i[u].prototype);c(n)},"17c2":function(t,e,o){"use strict";var i=o("b727").forEach,s=o("a640"),n=s("forEach");t.exports=n?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},2532:function(t,e,o){"use strict";var i=o("23e7"),s=o("e330"),n=o("5a34"),r=o("1d80"),a=o("577e"),c=o("ab13"),u=s("".indexOf);i({target:"String",proto:!0,forced:!c("includes")},{includes:function(t){return!!~u(a(r(this)),a(n(t)),arguments.length>1?arguments[1]:void 0)}})},"44e7":function(t,e,o){var i=o("861d"),s=o("c6b6"),n=o("b622"),r=n("match");t.exports=function(t){var e;return i(t)&&(void 0!==(e=t[r])?!!e:"RegExp"==s(t))}},"464a":function(t,e,o){t.exports=o.p+"img/carbon_bus_w.21b33b66.svg"},"529f":function(t,e,o){t.exports=o.p+"img/walkbus.665fe3f1.svg"},"5a34":function(t,e,o){var i=o("da84"),s=o("44e7"),n=i.TypeError;t.exports=function(t){if(s(t))throw n("The method doesn't accept regular expressions");return t}},8418:function(t,e,o){"use strict";var i=o("a04b"),s=o("9bf2"),n=o("5c6c");t.exports=function(t,e,o){var r=i(e);r in t?s.f(t,r,n(0,o)):t[r]=o}},"8fb6":function(t,e,o){"use strict";o.r(e);o("caad"),o("2532");var i=o("7a23"),s=o("42f0"),n=o.n(s),r={class:"h-100 d-flex flex-column"},a={class:"bread-bar"},c={class:"breadcrumb m-0 d-md-flex d-none"},u=Object(i["h"])("li",{class:"breadcrumb-item"},[Object(i["h"])("a",{href:"#"},"首頁")],-1),l={class:"breadcrumb-item active","aria-current":"page"},p={key:0},h={class:"mobile-control-bar d-flex d-md-none"},f={class:"city"},b=Object(i["h"])("span",{class:"material-icons"}," location_on ",-1),d={key:0},m={class:"tool"},O=Object(i["h"])("i",{class:"bi bi-pin-map me-1"},null,-1),y=Object(i["j"])("地圖 "),g=[O,y],v=Object(i["h"])("i",{class:"bi bi-clock me-1"},null,-1),j=Object(i["j"])("時刻表 "),k=[v,j],S=Object(i["h"])("i",{class:"bi bi-map me-1"},null,-1),w=Object(i["j"])("路線 "),x=[S,w],R={class:"map-wrap"},T={class:"route-search-area active"},P={class:"route-search-header"},L={class:"route-search-body"},N={class:"route-list"},I=["onClick"],D={class:"d-flex justify-content-between"},C={class:"title"},E={class:"icon"},U=["onClick"],A={key:0,class:"material-icons love"},B={key:1,class:"material-icons"},J={class:"d-flex justify-content-between"},_={class:"od"},M={class:"city"},$={key:0},W={class:"route-stop-area"},q=Object(i["h"])("span",{class:"material-icons"},"chevron_left",-1),G=Object(i["j"])(" 返回搜尋 "),z=[q,G],Z={class:"refresh-bar"},F={class:"time"},K=Object(i["h"])("span",{class:"material-icons"},"autorenew",-1),H=Object(i["j"])(" 立即更新 "),V=[K,H],X={class:"route-stop-header"},Q={class:"route-name"},Y={key:0,class:"material-icons love"},tt={key:1,class:"material-icons"},et={class:"nav nav-tabs",role:"tablist"},ot={class:"nav-item od-nav",role:"presentation"},it={key:0,class:"fw-700 truncateText"},st={class:"nav-item od-nav",role:"presentation"},nt={key:0,class:"fw-700 truncateText"},rt={class:"route-stop-content"},at={class:"tab-content py-3",id:"routeTabContent"},ct={key:0,class:"tab-pane fade show active",id:"go",role:"tabpanel"},ut={class:"route-stop-list"},lt=["onClick"],pt={key:0},ht={key:0},ft={key:1},bt={key:2},dt={key:1},mt={key:2},Ot={key:3},yt={key:4},gt={class:"stop-name"},vt={class:"plate-numb"},jt={key:0},kt={key:1,class:"tab-pane fade",id:"back",role:"tabpanel"},St={class:"route-stop-list"},wt=["onClick"],xt={key:0},Rt={key:0},Tt={key:1},Pt={key:2},Lt={key:1},Nt={key:2},It={key:3},Dt={key:4},Ct={class:"plate-numb"},Et={key:0},Ut=Object(i["h"])("img",{src:n.a,class:"icon-filter",alt:"gps-icon"},null,-1),At=[Ut],Bt=Object(i["h"])("div",{class:"map",id:"map"},null,-1);function Jt(t,e,o,s,n,O){return Object(i["w"])(),Object(i["g"])("div",r,[Object(i["h"])("div",a,[Object(i["h"])("ol",c,[u,Object(i["h"])("li",l,[n.city?(Object(i["w"])(),Object(i["g"])("span",p,Object(i["G"])(t.$filters.replaceCity(n.city)),1)):Object(i["f"])("",!0)])]),Object(i["h"])("div",h,[Object(i["h"])("div",f,[b,n.city?(Object(i["w"])(),Object(i["g"])("span",d,Object(i["G"])(t.$filters.replaceCity(n.city)),1)):Object(i["f"])("",!0)]),Object(i["h"])("div",m,[Object(i["h"])("div",{class:Object(i["q"])(["map",{active:"map"===n.mobileTool}]),onClick:e[0]||(e[0]=function(t){return O.showArea("map")})},g,2),n.stopOfRouteBack.length>0&&n.stopOfRouteTo.length>0?(Object(i["w"])(),Object(i["g"])("div",{key:0,class:Object(i["q"])(["time",{active:"time"===n.mobileTool}]),onClick:e[1]||(e[1]=function(t){return O.showArea("time")})},k,2)):Object(i["f"])("",!0),Object(i["h"])("div",{class:Object(i["q"])(["route",{active:"route"===n.mobileTool}]),onClick:e[2]||(e[2]=function(t){return O.showArea("route")})},x,2)])])]),Object(i["h"])("div",R,[Object(i["h"])("div",T,[Object(i["h"])("div",P,[Object(i["M"])(Object(i["h"])("input",{type:"search",class:"form-control",id:"routeNumber",placeholder:"請輸入公車路線","onUpdate:modelValue":e[3]||(e[3]=function(t){return n.routeKeyword=t}),onKeyup:e[4]||(e[4]=function(t){return O.getRoute()})},null,544),[[i["I"],n.routeKeyword]])]),Object(i["h"])("div",L,[Object(i["h"])("ul",N,[(Object(i["w"])(!0),Object(i["g"])(i["a"],null,Object(i["B"])(n.routeList,(function(e){return Object(i["w"])(),Object(i["g"])("li",{class:"route-list-item",key:e.RouteUID,onClick:function(t){return O.toRouteDetailClick(e)}},[Object(i["h"])("div",D,[Object(i["h"])("div",C,Object(i["G"])(e.RouteName.Zh_tw),1),Object(i["h"])("div",E,[Object(i["h"])("a",{href:"#",onClick:Object(i["N"])((function(t){return O.updateLikes(e)}),["prevent"])},[n.buslikesId.includes(e.RouteUID)?(Object(i["w"])(),Object(i["g"])("span",A," favorite ")):(Object(i["w"])(),Object(i["g"])("span",B," favorite_border "))],8,U)])]),Object(i["h"])("div",J,[Object(i["h"])("div",_,Object(i["G"])(e.DepartureStopNameZh)+"-"+Object(i["G"])(e.DestinationStopNameZh),1),Object(i["h"])("div",M,[n.city?(Object(i["w"])(),Object(i["g"])("span",$,Object(i["G"])(t.$filters.replaceCity(n.city)),1)):Object(i["f"])("",!0)])])],8,I)})),128))])])]),Object(i["h"])("div",W,[Object(i["h"])("a",{href:"#",class:"return",onClick:e[5]||(e[5]=Object(i["N"])((function(t){return O.backToRouteSeachList()}),["prevent"]))},z),Object(i["h"])("div",Z,[Object(i["h"])("div",F,Object(i["G"])(n.refreshTime)+" 秒後更新",1),Object(i["h"])("a",{href:"#",class:"refresh ms-auto",onClick:e[6]||(e[6]=Object(i["N"])((function(t){return O.getStopOfRoute()}),["prevent"]))},V)]),Object(i["h"])("div",X,[Object(i["h"])("div",Q,[Object(i["j"])(Object(i["G"])(n.selectRoute)+" ",1),Object(i["h"])("a",{href:"#",onClick:e[7]||(e[7]=Object(i["N"])((function(t){return O.updateLikes_(n.selectRoute,n.selectRouteUID,n.stopOfRouteBack[n.stopOfRouteBack.length-1].StopName.Zh_tw,n.stopOfRouteTo[n.stopOfRouteTo.length-1].StopName.Zh_tw,n.city)}),["prevent"]))},[n.buslikesId.includes(n.selectRouteUID)?(Object(i["w"])(),Object(i["g"])("span",Y," favorite ")):(Object(i["w"])(),Object(i["g"])("span",tt," favorite_border "))])])]),Object(i["h"])("ul",et,[Object(i["h"])("li",ot,[Object(i["h"])("button",{class:Object(i["q"])(["nav-link",{active:"to"===n.toOrBack}]),id:"go-tab","data-bs-toggle":"tab","data-bs-target":"#go",type:"button",onClick:e[8]||(e[8]=function(t){return O.changeToOrBack("to")})},[n.stopOfRouteTo.length>0?(Object(i["w"])(),Object(i["g"])("div",it,"往 "+Object(i["G"])(n.stopOfRouteTo[n.stopOfRouteTo.length-1].StopName.Zh_tw),1)):Object(i["f"])("",!0)],2)]),Object(i["h"])("li",st,[Object(i["h"])("button",{class:Object(i["q"])(["nav-link",{active:"back"===n.toOrBack}]),id:"back-tab","data-bs-toggle":"tab","data-bs-target":"#back",type:"button",onClick:e[9]||(e[9]=function(t){return O.changeToOrBack("back")})},[n.stopOfRouteBack.length>0?(Object(i["w"])(),Object(i["g"])("div",nt,"往 "+Object(i["G"])(n.stopOfRouteBack[n.stopOfRouteBack.length-1].StopName.Zh_tw),1)):Object(i["f"])("",!0)],2)])]),Object(i["h"])("div",rt,[Object(i["h"])("div",at,[n.stopOfRouteTo.length>0?(Object(i["w"])(),Object(i["g"])("div",ct,[Object(i["h"])("ul",ut,[(Object(i["w"])(!0),Object(i["g"])(i["a"],null,Object(i["B"])(n.stopOfRouteTo,(function(e){return Object(i["w"])(),Object(i["g"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return O.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(i["h"])("div",{class:Object(i["q"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",pt,[e.EstimateTime<=180&&e.PlateNumb?(Object(i["w"])(),Object(i["g"])("span",ht,"進站中")):e.EstimateTime<=180?(Object(i["w"])(),Object(i["g"])("span",ft,"即將進站")):(Object(i["w"])(),Object(i["g"])("span",bt,Object(i["G"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",dt,"尚未發車")):2===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",mt,"交管不停靠")):3===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",Ot,"末班車已過")):(Object(i["w"])(),Object(i["g"])("span",yt,"今日未營運"))],2),Object(i["h"])("div",gt,Object(i["G"])(e.StopName.Zh_tw),1),Object(i["h"])("div",vt,[e.PlateNumb?(Object(i["w"])(),Object(i["g"])("span",jt,Object(i["G"])(e.PlateNumb),1)):Object(i["f"])("",!0)]),Object(i["h"])("div",{class:Object(i["q"])(["status-dot",{"bus-on":e.PlateNumb}])},null,2)],8,lt)})),128))])])):Object(i["f"])("",!0),n.stopOfRouteBack.length>0?(Object(i["w"])(),Object(i["g"])("div",kt,[Object(i["h"])("ul",St,[(Object(i["w"])(!0),Object(i["g"])(i["a"],null,Object(i["B"])(n.stopOfRouteBack,(function(e){return Object(i["w"])(),Object(i["g"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return O.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(i["h"])("div",{class:Object(i["q"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",xt,[e.EstimateTime<=180&&e.PlateNumb?(Object(i["w"])(),Object(i["g"])("span",Rt,"進站中")):e.EstimateTime<=180?(Object(i["w"])(),Object(i["g"])("span",Tt,"即將進站")):(Object(i["w"])(),Object(i["g"])("span",Pt,Object(i["G"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",Lt,"尚未發車")):2===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",Nt,"交管不停靠")):3===e.StopStatus?(Object(i["w"])(),Object(i["g"])("span",It,"末班車已過")):(Object(i["w"])(),Object(i["g"])("span",Dt,"今日未營運"))],2),Object(i["h"])("div",{class:Object(i["q"])(["stop-name",{active:e.PlateNumb,disconnect:0!==e.StopStatus}])},Object(i["G"])(e.StopName.Zh_tw),3),Object(i["h"])("div",Ct,[e.PlateNumb?(Object(i["w"])(),Object(i["g"])("span",Et,Object(i["G"])(e.PlateNumb),1)):Object(i["f"])("",!0)]),Object(i["h"])("div",{class:Object(i["q"])(["status-dot",{"bus-on":e.PlateNumb,"bus-close":e.EstimateTime<=180}])},null,2)],8,wt)})),128))])])):Object(i["f"])("",!0)])])]),Object(i["h"])("div",{class:"gps-icon",onClick:e[10]||(e[10]=function(t){return O.locateGPS()})},At),Bt])])}o("99af"),o("b0c0"),o("d3b7"),o("159b"),o("e9c4"),o("d81d"),o("a434");var _t=o("e11e"),Mt=o.n(_t),$t=o("11343"),Wt=o.n($t),qt={},Gt=new Mt.a.Icon({iconUrl:o("529f"),iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]}),zt=new Mt.a.Icon({iconUrl:o("0168"),iconSize:[28,28],iconAnchor:[14,14],popupAnchor:[0,-14]}),Zt=new Mt.a.Icon({iconUrl:o("fc97"),iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),Ft=new Mt.a.Icon({iconUrl:o("e275"),iconSize:[49,49],iconAnchor:[24,24],popupAnchor:[0,-24]}),Kt={data:function(){return{city:"",routeList:[],routeKeyword:"",stopOfRouteTo:[],stopOfRouteBack:[],selectRoute:"",selectRouteUID:"",toOrBack:"to",routeGeometry:[],routeLayer:null,locationMarkerID:"",walkBusMarker:[],stopMarker:[],mobileTool:"route",timer:null,refreshTime:0,buslikes:[],buslikesId:[],prevRoute:null}},methods:{getRoute:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/".concat(this.city,"/").concat(this.routeKeyword,"?$top=50&$format=JSON");this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){t.routeList=e.data})).catch((function(t){console.log(t)}))},toRouteDetailClick:function(t){"SPAN"!==event.target.tagName&&(this.toRouteDetail(t.RouteName.Zh_tw,t.RouteUID),this.fitBounds())},toRouteDetail:function(t,e){document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"),this.selectRoute=t,this.selectRouteUID=e,this.mobileTool="time",this.getStopOfRoute()},backToRouteSeachList:function(){this.prevRoute?"nearStation"!==this.prevRoute.name&&"busSearch"!==this.prevRoute.name&&"likeBus"!==this.prevRoute.name?(document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")):this.$router.go(-1):(document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active"))},getStopOfRoute:function(){var t=this;this.timer&&clearInterval(this.timer),this.timeCountDown(21);var e="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/".concat(this.city,"?$filter=RouteUID%20eq%20'").concat(this.selectRouteUID,"'&$format=JSON");this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){e.data.forEach((function(e){0===e.Direction?t.stopOfRouteTo=e.Stops:1===e.Direction&&(t.stopOfRouteBack=e.Stops)})),t.getEstimateTime(t.selectRoute,t.selectRouteUID)})).catch((function(t){console.log(t)}))},getEstimateTime:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20in%20('").concat(e,"')&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(i){i.data.forEach((function(t){0===t.Direction&&o.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)})),1===t.Direction&&o.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)}))})),o.getPlateNum(t,e)})).catch((function(t){console.log(t)}))},getPlateNum:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/RealTimeNearStop/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(i){i.data.forEach((function(t){0===t.Direction&&o.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)})),1===t.Direction&&o.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)}))})),o.getRouteGeometry(t,e)})).catch((function(t){console.log(t)}))},getRouteGeometry:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/Shape/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(t){o.routeGeometry=t.data,qt.eachLayer((function(t){t._leaflet_id!==o.locationMarkerID&&(t instanceof Mt.a.Marker&&qt.removeLayer(t),t instanceof Mt.a.Popup&&qt.removeLayer(t),t.toGeoJSON&&qt.removeLayer(t))})),o.addRouteLayer()})).catch((function(t){console.log(t)}))},addRouteLayer:function(){var t=this,e={color:"#345E8A",weight:4},o=null;this.routeGeometry.forEach((function(i){var s=new Wt.a.Wkt;s.read(i.Geometry);var n=s.toJson();try{o=Mt.a.geoJSON(n,{style:e}).addTo(qt),o.addData(n),t.routeLayer=o,t.addRouteMarker()}catch(r){console.log(r)}}))},changeToOrBack:function(t){this.toOrBack=t,this.addRouteMarker()},addRouteMarker:function(){var t=this,e=[];e="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),qt.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof Mt.a.Marker&&qt.removeLayer(e),e instanceof Mt.a.Popup&&qt.removeLayer(e))}));var o=qt.getZoom();o>15?this.zoomLevelAddMarker():e.forEach((function(t,o){if(t.PlateNumb){var i=Mt.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:Gt});i.addTo(qt)}else if(0===o||o===e.length-1){var s=Mt.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:Zt});s.addTo(qt)}}))},zoomLevelAddMarker:function(){var t=this;if(this.stopOfRouteTo.length>0&&this.stopOfRouteBack.length>0){var e=qt.getZoom();if(e<=15)this.addRouteMarker();else{var o=[];o="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),qt.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof Mt.a.Marker&&qt.removeLayer(e),e instanceof Mt.a.Popup&&qt.removeLayer(e))})),o.forEach((function(e,o){var i=t.createPopupContent(e),s=Mt.a.popup({autoPan:!1,className:i.status,offset:[0,-12]});if(s.setLatLng(Mt.a.latLng(e.StopPosition.PositionLat,e.StopPosition.PositionLon)),s.setContent(i.str),qt.addLayer(s),"popupWarning"===i.status){var n=Mt.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:zt}).bindPopup(s);n.addTo(qt)}else{var r=Mt.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:Zt}).bindPopup(s);r.addTo(qt)}}))}}},createPopupContent:function(t){var e="",i="popupPrimary";0===t.StopStatus?t.EstimateTime<=180&&t.PlateNumb?(e="進站中",i="popupWarning"):t.EstimateTime<=180?(e="即將進站",i="popupWarning"):e=this.$filters.toMinute(t.EstimateTime)+" 分":1===t.StopStatus?(e="尚未發車",i="popupSecondary"):2===t.StopStatus?(e="交管不停靠",i="popupSecondary"):3===t.StopStatus&&(e="末班車已過",i="popupSecondary");var s=o("464a"),n=t.PlateNumb?'<img src="'.concat(s,'" height="25" alt="icon">'):"",r='\n      <div class="stop-popup">\n        '.concat(n,'\n        <div class="name">').concat(t.StopName.Zh_tw,'</div>\n        <div class="time">').concat(e," </div>\n      </div>\n      ");return{str:r,status:i}},panToPosition:function(t,e){qt.setView([t,e],18),window.innerWidth<768&&this.showArea("map")},locateGPS:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){qt.eachLayer((function(e){e._leaflet_id===t.locationMarkerID&&qt.removeLayer(e)}));var o=[e.coords.latitude,e.coords.longitude];qt.setView(o,15),document.querySelector(".gps-icon").classList.add("active");var i=Mt.a.marker([e.coords.latitude,e.coords.longitude],{icon:Ft});i.addTo(qt),t.locationMarkerID=i._leaflet_id}))},showArea:function(t){"map"===t?(this.mobileTool="map",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.remove("active")):"route"===t?(this.mobileTool="route",document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")):"time"===t&&(this.mobileTool="time",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"))},getParam:function(){var t=""+this.$route.params.queryString,e=JSON.parse(t);this.city=e.city,e.route&&e.routeUID&&(this.selectRoute=e.route,this.selectRouteUID=e.routeUID,this.toOrBack=0===e.direction?"to":"back",this.toRouteDetail(this.selectRoute,this.selectRouteUID),e.LatLon.length>0?this.panToPosition(e.LatLon[0],e.LatLon[1]):this.fitBounds())},fitBounds:function(){var t=this;setTimeout((function(){console.log("setTimeOut"),qt.fitBounds(t.routeLayer.getBounds())}),500)},timeCountDown:function(t){var e=this,o=t;this.timer=setInterval((function(){o>0?(o--,e.refreshTime=o):(clearInterval(e.timer),e.getStopOfRoute())}),1e3)},getLikes:function(){var t=localStorage.getItem("busLikes")?localStorage.getItem("busLikes"):"[]";this.buslikes=JSON.parse(t),this.buslikesId=this.buslikes.map((function(t){return t.routeUID}))},updateLikes_:function(t,e,o,i,s){this.buslikesId.includes(e)?(this.buslikes.splice(this.buslikes.map((function(t){return t.routeUID})).indexOf(e),1),this.buslikesId.splice(this.buslikesId.indexOf(e),1)):(this.buslikes.push({routeUID:e,routeName:t,start:o,end:i,city:s}),this.buslikesId.push(e))},updateLikes:function(t){this.buslikesId.includes(t.RouteUID)?(this.buslikes.splice(this.buslikes.map((function(t){return t.routeUID})).indexOf(t.RouteUID),1),this.buslikesId.splice(this.buslikesId.indexOf(t.RouteUID),1)):(this.buslikes.push({routeUID:t.RouteUID,routeName:t.RouteName.Zh_tw,start:t.DepartureStopNameZh,end:t.DestinationStopNameZh,city:this.city}),this.buslikesId.push(t.RouteUID))},saveLocalStorage:function(t){var e=JSON.stringify(t);try{localStorage.setItem("busLikes",e)}catch(o){return!1}}},watch:{buslikes:{handler:function(t,e){this.saveLocalStorage(this.buslikes)},deep:!0}},beforeRouteEnter:function(t,e,o){o((function(t){t.prevRoute=e}))},mounted:function(){qt=Mt.a.map("map",{zoomControl:!1,center:[23.51357237187571,120.21110434230025],zoom:8,tap:!1}),Mt.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(qt),Mt.a.control.zoom({position:"bottomright"}).addTo(qt),qt.on("moveend",(function(){document.querySelector(".gps-icon").classList.remove("active")}));var t=this.zoomLevelAddMarker;qt.on("zoomend",(function(){t()})),this.getParam(),this.getLikes()},unmounted:function(){this.timer&&clearInterval(this.timer)}},Ht=o("6b0d"),Vt=o.n(Ht);const Xt=Vt()(Kt,[["render",Jt]]);e["default"]=Xt},"99af":function(t,e,o){"use strict";var i=o("23e7"),s=o("da84"),n=o("d039"),r=o("e8b5"),a=o("861d"),c=o("7b0b"),u=o("07fa"),l=o("8418"),p=o("65f0"),h=o("1dde"),f=o("b622"),b=o("2d00"),d=f("isConcatSpreadable"),m=9007199254740991,O="Maximum allowed index exceeded",y=s.TypeError,g=b>=51||!n((function(){var t=[];return t[d]=!1,t.concat()[0]!==t})),v=h("concat"),j=function(t){if(!a(t))return!1;var e=t[d];return void 0!==e?!!e:r(t)},k=!g||!v;i({target:"Array",proto:!0,forced:k},{concat:function(t){var e,o,i,s,n,r=c(this),a=p(r,0),h=0;for(e=-1,i=arguments.length;e<i;e++)if(n=-1===e?r:arguments[e],j(n)){if(s=u(n),h+s>m)throw y(O);for(o=0;o<s;o++,h++)o in n&&l(a,h,n[o])}else{if(h>=m)throw y(O);l(a,h++,n)}return a.length=h,a}})},a434:function(t,e,o){"use strict";var i=o("23e7"),s=o("da84"),n=o("23cb"),r=o("5926"),a=o("07fa"),c=o("7b0b"),u=o("65f0"),l=o("8418"),p=o("1dde"),h=p("splice"),f=s.TypeError,b=Math.max,d=Math.min,m=9007199254740991,O="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!h},{splice:function(t,e){var o,i,s,p,h,y,g=c(this),v=a(g),j=n(t,v),k=arguments.length;if(0===k?o=i=0:1===k?(o=0,i=v-j):(o=k-2,i=d(b(r(e),0),v-j)),v+o-i>m)throw f(O);for(s=u(g,i),p=0;p<i;p++)h=j+p,h in g&&l(s,p,g[h]);if(s.length=i,o<i){for(p=j;p<v-i;p++)h=p+i,y=p+o,h in g?g[y]=g[h]:delete g[y];for(p=v;p>v-i+o;p--)delete g[p-1]}else if(o>i)for(p=v-i;p>j;p--)h=p+i-1,y=p+o-1,h in g?g[y]=g[h]:delete g[y];for(p=0;p<o;p++)g[p+j]=arguments[p+2];return g.length=v-i+o,s}})},a640:function(t,e,o){"use strict";var i=o("d039");t.exports=function(t,e){var o=[][t];return!!o&&i((function(){o.call(null,e||function(){throw 1},1)}))}},ab13:function(t,e,o){var i=o("b622"),s=i("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(o){try{return e[s]=!1,"/./"[t](e)}catch(i){}}return!1}},b0c0:function(t,e,o){var i=o("83ab"),s=o("5e77").EXISTS,n=o("e330"),r=o("9bf2").f,a=Function.prototype,c=n(a.toString),u=/^\s*function ([^ (]*)/,l=n(u.exec),p="name";i&&!s&&r(a,p,{configurable:!0,get:function(){try{return l(u,c(this))[1]}catch(t){return""}}})},caad:function(t,e,o){"use strict";var i=o("23e7"),s=o("4d64").includes,n=o("44d2");i({target:"Array",proto:!0},{includes:function(t){return s(this,t,arguments.length>1?arguments[1]:void 0)}}),n("includes")},e9c4:function(t,e,o){var i=o("23e7"),s=o("da84"),n=o("d066"),r=o("2ba4"),a=o("e330"),c=o("d039"),u=s.Array,l=n("JSON","stringify"),p=a(/./.exec),h=a("".charAt),f=a("".charCodeAt),b=a("".replace),d=a(1..toString),m=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,g=function(t,e,o){var i=h(o,e-1),s=h(o,e+1);return p(O,t)&&!p(y,s)||p(y,t)&&!p(O,i)?"\\u"+d(f(t,0),16):t},v=c((function(){return'"\\udf06\\ud834"'!==l("\udf06\ud834")||'"\\udead"'!==l("\udead")}));l&&i({target:"JSON",stat:!0,forced:v},{stringify:function(t,e,o){for(var i=0,s=arguments.length,n=u(s);i<s;i++)n[i]=arguments[i];var a=r(l,null,n);return"string"==typeof a?b(a,m,g):a}})},fc97:function(t,e,o){t.exports=o.p+"img/busStop.2fb86a4d.svg"}}]);
//# sourceMappingURL=chunk-8df0a5ee.cf57e690.js.map