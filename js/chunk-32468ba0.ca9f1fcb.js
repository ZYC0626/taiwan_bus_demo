(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-32468ba0"],{"0168":function(t,e,o){t.exports=o.p+"img/busStop_in.bee2e2f7.svg"},11343:function(t,e,o){var i;
/** @license
 *
 *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
 *  Michigan Tech Research Institute (MTRI)
 *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */(function(n,s){i=function(){return s()}.call(e,o,e,t),void 0===i||(t.exports=i)})(0,(function(){var t,e,o;return this,o=function(t){return t instanceof o?t:this instanceof o?void(this._wrapped=t):new o(t)},t=function(t,e){return t.substring(0,e.length)===e},e=function(t,e){return t.substring(t.length-e.length)===e},o.delimiter=" ",o.isArray=function(t){return!(!t||t.constructor!==Array)},o.trim=function(o,i){i=i||" ";while(t(o,i))o=o.substring(1);while(e(o,i))o=o.substring(0,o.length-1);return o},o.Wkt=function(t){this.delimiter=o.delimiter||" ",this.wrapVertices=!0,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/},this._stripWhitespaceAndParens=function(t){var e=t.trim(),o=e.replace(/^\(?(.*?)\)?$/,"$1");return o},this.components=void 0,t&&"string"===typeof t?this.read(t):t&&void 0!==typeof t&&this.fromObject(t)},o.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case"multi":return!0;case"polyg":return!0;default:return!1}},o.Wkt.prototype.sameCoords=function(t,e){return t.x===e.x&&t.y===e.y},o.Wkt.prototype.fromObject=function(t){var e;return e=t.hasOwnProperty("type")&&t.hasOwnProperty("coordinates")?this.fromJson(t):this.deconstruct.call(this,t),this.components=e.components,this.isRectangle=e.isRectangle||!1,this.type=e.type,this},o.Wkt.prototype.toObject=function(t){var e=this.construct[this.type].call(this,t);return"object"!==typeof e||o.isArray(e)||(e.properties=this.properties),e},o.Wkt.prototype.toString=function(t){return this.write()},o.Wkt.prototype.fromJson=function(t){var e,i,n,s,a,r;if(this.type=t.type.toLowerCase(),this.components=[],t.hasOwnProperty("geometry"))return this.fromJson(t.geometry),this.properties=t.properties,this;if(s=t.coordinates,o.isArray(s[0])){for(e in s)if(s.hasOwnProperty(e))if(o.isArray(s[e][0])){for(i in r=[],s[e])if(s[e].hasOwnProperty(i))if(o.isArray(s[e][i][0])){for(n in a=[],s[e][i])s[e][i].hasOwnProperty(n)&&a.push({x:s[e][i][n][0],y:s[e][i][n][1]});r.push(a)}else r.push({x:s[e][i][0],y:s[e][i][1]});this.components.push(r)}else"multipoint"===this.type?this.components.push([{x:s[e][0],y:s[e][1]}]):this.components.push({x:s[e][0],y:s[e][1]})}else this.components.push({x:s[0],y:s[1]});return this},o.Wkt.prototype.toJson=function(){var t,e,i,n,s,a,r;if(t=this.components,e={coordinates:[],type:function(){var t,e,o;for(t in e=this.regExes.ogcTypes.exec(this.type).slice(1),o=[],e)e.hasOwnProperty(t)&&void 0!==e[t]&&o.push(e[t].toLowerCase().slice(0,1).toUpperCase()+e[t].toLowerCase().slice(1));return o}.call(this).join("")},"box"===this.type.toLowerCase()){for(i in e.type="Polygon",e.bbox=[],t)t.hasOwnProperty(i)&&(e.bbox=e.bbox.concat([t[i].x,t[i].y]));return e.coordinates=[[[t[0].x,t[0].y],[t[0].x,t[1].y],[t[1].x,t[1].y],[t[1].x,t[0].y],[t[0].x,t[0].y]]],e}for(i in t)if(t.hasOwnProperty(i))if(o.isArray(t[i])){for(n in r=[],t[i])if(t[i].hasOwnProperty(n))if(o.isArray(t[i][n])){for(s in a=[],t[i][n])t[i][n].hasOwnProperty(s)&&a.push([t[i][n][s].x,t[i][n][s].y]);r.push(a)}else t[i].length>1?r.push([t[i][n].x,t[i][n].y]):r=r.concat([t[i][n].x,t[i][n].y]);e.coordinates.push(r)}else t.length>1?e.coordinates.push([t[i].x,t[i].y]):e.coordinates=e.coordinates.concat([t[i].x,t[i].y]);return e},o.Wkt.prototype.merge=function(t){var e=this.type.slice(0,5);if(this.type!==t.type&&this.type.slice(5,this.type.length)!==t.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(e){case"point":this.components=[this.components.concat(t.components)];break;case"multi":this.components=this.components.concat("multi"===t.type.slice(0,5)?t.components:[t.components]);break;default:this.components=[this.components,t.components];break}return"multi"!==e&&(this.type="multi"+this.type),this},o.Wkt.prototype.read=function(t){var e;if(e=this.regExes.typeStr.exec(t),e)this.type=e[1].toLowerCase(),this.base=e[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else{if(!this.regExes.crudeJson.test(t))throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",message:"Invalid WKT string provided to read()"};if("object"!==typeof JSON||"function"!==typeof JSON.parse)throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};this.fromJson(JSON.parse(t))}return this},o.Wkt.prototype.write=function(t){var e,o,i;for(t=t||this.components,o=[],o.push(this.type.toUpperCase()+"("),e=0;e<t.length;e+=1){if(this.isCollection()&&e>0&&o.push(","),!this.extract[this.type])return null;i=this.extract[this.type].apply(this,[t[e]]),this.isCollection()&&"multipoint"!==this.type?o.push("("+i+")"):(o.push(i),e!==t.length-1&&"multipoint"!==this.type&&o.push(","))}return o.push(")"),o.join("")},o.Wkt.prototype.extract={point:function(t){return String(t.x)+this.delimiter+String(t.y)},multipoint:function(t){var e,o,i=[];for(e=0;e<t.length;e+=1)o=this.extract.point.apply(this,[t[e]]),this.wrapVertices&&(o="("+o+")"),i.push(o);return i.join(",")},linestring:function(t){return this.extract.point.apply(this,[t])},multilinestring:function(t){var e,o=[];if(t.length)for(e=0;e<t.length;e+=1)o.push(this.extract.linestring.apply(this,[t[e]]));else o.push(this.extract.point.apply(this,[t]));return o.join(",")},polygon:function(t){return this.extract.multilinestring.apply(this,[t])},multipolygon:function(t){var e,o=[];for(e=0;e<t.length;e+=1)o.push("("+this.extract.polygon.apply(this,[t[e]])+")");return o.join(",")},box:function(t){return this.extract.linestring.apply(this,[t])},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},o.Wkt.prototype.ingest={point:function(t){var e=o.trim(t).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(e[0])[0]),y:parseFloat(this.regExes.numeric.exec(e[1])[0])}]},multipoint:function(t){var e,i,n;for(i=[],n=o.trim(t).split(this.regExes.comma),e=0;e<n.length;e+=1)i.push(this.ingest.point.apply(this,[n[e]]));return i},linestring:function(t){var e,o,i;for(o=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<o.length;e+=1)i=i.concat(o[e]);return i},multilinestring:function(t){var e,i,n,s;for(i=[],s=o.trim(t).split(this.regExes.doubleParenComma),1===s.length&&(s=o.trim(t).split(this.regExes.parenComma)),e=0;e<s.length;e+=1)n=this._stripWhitespaceAndParens(s[e]),i.push(this.ingest.linestring.apply(this,[n]));return i},polygon:function(t){var e,i,n,s,a,r;for(r=o.trim(t).split(this.regExes.parenComma),n=[],e=0;e<r.length;e+=1){for(a=this._stripWhitespaceAndParens(r[e]).split(this.regExes.comma),s=[],i=0;i<a.length;i+=1){var c=a[i].split(this.regExes.spaces);if(c.length>2&&(c=c.filter((function(t){return""!=t}))),2===c.length){var u=c[0],p=c[1];s.push({x:parseFloat(u),y:parseFloat(p)})}}n.push(s)}return n},box:function(t){var e,o,i;for(o=this.ingest.multipoint.apply(this,[t]),i=[],e=0;e<o.length;e+=1)i=i.concat(o[e]);return i},multipolygon:function(t){var e,i,n,s;for(i=[],s=o.trim(t).split(this.regExes.doubleParenComma),e=0;e<s.length;e+=1)n=this._stripWhitespaceAndParens(s[e]),i.push(this.ingest.polygon.apply(this,[n]));return i},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},o}))},"159b":function(t,e,o){var i=o("da84"),n=o("fdbc"),s=o("785a"),a=o("17c2"),r=o("9112"),c=function(t){if(t&&t.forEach!==a)try{r(t,"forEach",a)}catch(e){t.forEach=a}};for(var u in n)n[u]&&c(i[u]&&i[u].prototype);c(s)},"17c2":function(t,e,o){"use strict";var i=o("b727").forEach,n=o("a640"),s=n("forEach");t.exports=s?[].forEach:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}},"464a":function(t,e,o){t.exports=o.p+"img/carbon_bus_w.21b33b66.svg"},"529f":function(t,e,o){t.exports=o.p+"img/walkbus.665fe3f1.svg"},8418:function(t,e,o){"use strict";var i=o("a04b"),n=o("9bf2"),s=o("5c6c");t.exports=function(t,e,o){var a=i(e);a in t?n.f(t,a,s(0,o)):t[a]=o}},"8fb6":function(t,e,o){"use strict";o.r(e);var i=o("7a23"),n=o("42f0"),s=o.n(n),a={class:"h-100 d-flex flex-column"},r={class:"bread-bar"},c={class:"breadcrumb m-0 d-md-flex d-none"},u=Object(i["f"])("li",{class:"breadcrumb-item"},[Object(i["f"])("a",{href:"#"},"首頁")],-1),p={class:"breadcrumb-item active","aria-current":"page"},l={class:"mobile-control-bar d-flex d-md-none"},h={class:"city"},f=Object(i["f"])("span",{class:"material-icons"}," location_on ",-1),b={class:"tool"},d=Object(i["f"])("i",{class:"bi bi-pin-map me-1"},null,-1),m=Object(i["h"])("地圖 "),O=[d,m],y=Object(i["f"])("i",{class:"bi bi-clock me-1"},null,-1),g=Object(i["h"])("時刻表 "),v=[y,g],j=Object(i["f"])("i",{class:"bi bi-map me-1"},null,-1),S=Object(i["h"])("路線 "),k=[j,S],x={class:"map-wrap"},w={class:"route-search-area active"},P={class:"route-search-header"},T={class:"route-search-body"},R={class:"route-list"},L=["onClick"],N={class:"d-flex justify-content-between"},A={class:"title"},E=Object(i["f"])("div",{class:"icon"},[Object(i["f"])("a",null,[Object(i["f"])("span",{class:"material-icons"}," favorite_border ")])],-1),C={class:"d-flex justify-content-between"},D={class:"od"},I={class:"city"},J={class:"route-stop-area"},U=Object(i["f"])("span",{class:"material-icons"},"chevron_left",-1),B=Object(i["h"])(" 返回搜尋"),W=[U,B],M={class:"refresh-bar"},_=Object(i["f"])("span",{class:"material-icons"},"autorenew",-1),$=Object(i["h"])(" 立即更新 "),z=[_,$],q={class:"route-stop-header"},F={class:"route-name"},G={class:"nav nav-tabs",role:"tablist"},Z={class:"nav-item od-nav",role:"presentation"},K={key:0,class:"fw-700 truncateText"},H={class:"nav-item od-nav",role:"presentation"},V={key:0,class:"fw-700 truncateText"},Q={class:"route-stop-content"},X={class:"tab-content py-3",id:"routeTabContent"},Y={key:0,class:"tab-pane fade show active",id:"go",role:"tabpanel"},tt={class:"route-stop-list"},et=["onClick"],ot={key:0},it={key:0},nt={key:1},st={key:2},at={key:1},rt={key:2},ct={key:3},ut={key:4},pt={class:"stop-name"},lt={class:"plate-numb"},ht={key:0},ft={key:1,class:"tab-pane fade",id:"back",role:"tabpanel"},bt={class:"route-stop-list"},dt=["onClick"],mt={key:0},Ot={key:0},yt={key:1},gt={key:2},vt={key:1},jt={key:2},St={key:3},kt={key:4},xt={class:"plate-numb"},wt={key:0},Pt=Object(i["f"])("img",{src:s.a,class:"icon-filter",alt:"gps-icon"},null,-1),Tt=[Pt],Rt=Object(i["f"])("div",{class:"map",id:"map"},null,-1);function Lt(t,e,o,n,s,d){return Object(i["t"])(),Object(i["e"])("div",a,[Object(i["f"])("div",r,[Object(i["f"])("ol",c,[u,Object(i["f"])("li",p,Object(i["A"])(s.city),1)]),Object(i["f"])("div",l,[Object(i["f"])("div",h,[f,Object(i["h"])(Object(i["A"])(s.city),1)]),Object(i["f"])("div",b,[Object(i["f"])("div",{class:Object(i["o"])(["map",{active:"map"===s.mobileTool}]),onClick:e[0]||(e[0]=function(t){return d.showArea("map")})},O,2),s.stopOfRouteBack.length>0&&s.stopOfRouteTo.length>0?(Object(i["t"])(),Object(i["e"])("div",{key:0,class:Object(i["o"])(["time",{active:"time"===s.mobileTool}]),onClick:e[1]||(e[1]=function(t){return d.showArea("time")})},v,2)):Object(i["d"])("",!0),Object(i["f"])("div",{class:Object(i["o"])(["route",{active:"route"===s.mobileTool}]),onClick:e[2]||(e[2]=function(t){return d.showArea("route")})},k,2)])])]),Object(i["f"])("div",x,[Object(i["f"])("div",w,[Object(i["f"])("div",P,[Object(i["F"])(Object(i["f"])("input",{type:"search",class:"form-control",id:"routeNumber",placeholder:"請輸入公車路線","onUpdate:modelValue":e[3]||(e[3]=function(t){return s.routeKeyword=t}),onKeyup:e[4]||(e[4]=function(t){return d.getRoute()})},null,544),[[i["C"],s.routeKeyword]])]),Object(i["f"])("div",T,[Object(i["f"])("ul",R,[(Object(i["t"])(!0),Object(i["e"])(i["a"],null,Object(i["x"])(s.routeList,(function(t){return Object(i["t"])(),Object(i["e"])("li",{class:"route-list-item",key:t.RouteUID,onClick:function(e){return d.toRouteDetail(t.RouteName.Zh_tw,t.RouteUID)}},[Object(i["f"])("div",N,[Object(i["f"])("div",A,Object(i["A"])(t.RouteName.Zh_tw),1),E]),Object(i["f"])("div",C,[Object(i["f"])("div",D,Object(i["A"])(t.DepartureStopNameZh)+"-"+Object(i["A"])(t.DestinationStopNameZh),1),Object(i["f"])("div",I,Object(i["A"])(s.city),1)])],8,L)})),128))])])]),Object(i["f"])("div",J,[Object(i["f"])("a",{href:"#",class:"return",onClick:e[5]||(e[5]=Object(i["G"])((function(t){return d.backToRouteSeachList()}),["prevent"]))},W),Object(i["f"])("div",M,[Object(i["f"])("a",{href:"#",class:"refresh ms-auto",onClick:e[6]||(e[6]=Object(i["G"])((function(t){return d.getStopOfRoute()}),["prevent"]))},z)]),Object(i["f"])("div",q,[Object(i["f"])("div",F,Object(i["A"])(s.selectRoute),1)]),Object(i["f"])("ul",G,[Object(i["f"])("li",Z,[Object(i["f"])("button",{class:Object(i["o"])(["nav-link",{active:"to"===s.toOrBack}]),id:"go-tab","data-bs-toggle":"tab","data-bs-target":"#go",type:"button",onClick:e[7]||(e[7]=function(t){return d.changeToOrBack("to")})},[s.stopOfRouteTo.length>0?(Object(i["t"])(),Object(i["e"])("div",K,"往 "+Object(i["A"])(s.stopOfRouteTo[s.stopOfRouteTo.length-1].StopName.Zh_tw),1)):Object(i["d"])("",!0)],2)]),Object(i["f"])("li",H,[Object(i["f"])("button",{class:Object(i["o"])(["nav-link",{active:"back"===s.toOrBack}]),id:"back-tab","data-bs-toggle":"tab","data-bs-target":"#back",type:"button",onClick:e[8]||(e[8]=function(t){return d.changeToOrBack("back")})},[s.stopOfRouteBack.length>0?(Object(i["t"])(),Object(i["e"])("div",V,"往 "+Object(i["A"])(s.stopOfRouteBack[s.stopOfRouteBack.length-1].StopName.Zh_tw),1)):Object(i["d"])("",!0)],2)])]),Object(i["f"])("div",Q,[Object(i["f"])("div",X,[s.stopOfRouteTo.length>0?(Object(i["t"])(),Object(i["e"])("div",Y,[Object(i["f"])("ul",tt,[(Object(i["t"])(!0),Object(i["e"])(i["a"],null,Object(i["x"])(s.stopOfRouteTo,(function(e){return Object(i["t"])(),Object(i["e"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return d.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(i["f"])("div",{class:Object(i["o"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",ot,[e.EstimateTime<=180&&e.PlateNumb?(Object(i["t"])(),Object(i["e"])("span",it,"進站中")):e.EstimateTime<=180?(Object(i["t"])(),Object(i["e"])("span",nt,"即將進站")):(Object(i["t"])(),Object(i["e"])("span",st,Object(i["A"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",at,"尚未發車")):2===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",rt,"交管不停靠")):3===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",ct,"末班車已過")):(Object(i["t"])(),Object(i["e"])("span",ut,"今日未營運"))],2),Object(i["f"])("div",pt,Object(i["A"])(e.StopName.Zh_tw),1),Object(i["f"])("div",lt,[e.PlateNumb?(Object(i["t"])(),Object(i["e"])("span",ht,Object(i["A"])(e.PlateNumb),1)):Object(i["d"])("",!0)]),Object(i["f"])("div",{class:Object(i["o"])(["status-dot",{"bus-on":e.PlateNumb}])},null,2)],8,et)})),128))])])):Object(i["d"])("",!0),s.stopOfRouteBack.length>0?(Object(i["t"])(),Object(i["e"])("div",ft,[Object(i["f"])("ul",bt,[(Object(i["t"])(!0),Object(i["e"])(i["a"],null,Object(i["x"])(s.stopOfRouteBack,(function(e){return Object(i["t"])(),Object(i["e"])("li",{class:"route-stop-item",key:e.StopUID,onClick:function(t){return d.panToPosition(e.StopPosition.PositionLat,e.StopPosition.PositionLon)}},[Object(i["f"])("div",{class:Object(i["o"])(["time",{active:e.EstimateTime<=180,disconnect:0!==e.StopStatus}])},[0===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",mt,[e.EstimateTime<=180&&e.PlateNumb?(Object(i["t"])(),Object(i["e"])("span",Ot,"進站中")):e.EstimateTime<=180?(Object(i["t"])(),Object(i["e"])("span",yt,"即將進站")):(Object(i["t"])(),Object(i["e"])("span",gt,Object(i["A"])(t.$filters.toMinute(e.EstimateTime))+"分",1))])):1===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",vt,"尚未發車")):2===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",jt,"交管不停靠")):3===e.StopStatus?(Object(i["t"])(),Object(i["e"])("span",St,"末班車已過")):(Object(i["t"])(),Object(i["e"])("span",kt,"今日未營運"))],2),Object(i["f"])("div",{class:Object(i["o"])(["stop-name",{active:e.PlateNumb,disconnect:0!==e.StopStatus}])},Object(i["A"])(e.StopName.Zh_tw),3),Object(i["f"])("div",xt,[e.PlateNumb?(Object(i["t"])(),Object(i["e"])("span",wt,Object(i["A"])(e.PlateNumb),1)):Object(i["d"])("",!0)]),Object(i["f"])("div",{class:Object(i["o"])(["status-dot",{"bus-on":e.PlateNumb,"bus-close":e.EstimateTime<=180}])},null,2)],8,dt)})),128))])])):Object(i["d"])("",!0)])])]),Object(i["f"])("div",{class:"gps-icon",onClick:e[9]||(e[9]=function(t){return d.locateGPS()})},Tt),Rt])])}o("99af"),o("d3b7"),o("159b"),o("e9c4"),o("d81d");var Nt=o("e11e"),At=o.n(Nt),Et=o("11343"),Ct=o.n(Et),Dt={},It=new At.a.Icon({iconUrl:o("529f"),iconSize:[40,40],iconAnchor:[20,20],popupAnchor:[0,-20]}),Jt=new At.a.Icon({iconUrl:o("0168"),iconSize:[28,28],iconAnchor:[14,14],popupAnchor:[0,-14]}),Ut=new At.a.Icon({iconUrl:o("fc97"),iconSize:[24,24],iconAnchor:[12,12],popupAnchor:[0,-12]}),Bt=new At.a.Icon({iconUrl:o("e275"),iconSize:[49,49],iconAnchor:[24,24],popupAnchor:[0,-24]}),Wt={data:function(){return{city:"",routeList:[],routeKeyword:"",stopOfRouteTo:[],stopOfRouteBack:[],selectRoute:"",selectRouteUID:"",toOrBack:"to",routeGeometry:[],locationMarkerID:"",walkBusMarker:[],stopMarker:[],mobileTool:"route"}},methods:{getRoute:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bus/Route/City/".concat(this.city,"/").concat(this.routeKeyword,"?$top=50&$format=JSON");this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){t.routeList=e.data})).catch((function(t){console.log(t)}))},toRouteDetail:function(t,e){document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"),this.selectRoute=t,this.selectRouteUID=e,this.mobileTool="time",this.getStopOfRoute()},backToRouteSeachList:function(){document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")},getStopOfRoute:function(){var t=this,e="https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/".concat(this.city,"?$filter=RouteUID%20eq%20'").concat(this.selectRouteUID,"'&$format=JSON");this.axios.get(e,{headers:this.$getAuthorizationHeader()}).then((function(e){e.data.forEach((function(e){0===e.Direction?t.stopOfRouteTo=e.Stops:1===e.Direction&&(t.stopOfRouteBack=e.Stops)})),t.getEstimateTime(t.selectRoute,t.selectRouteUID)})).catch((function(t){console.log(t)}))},getEstimateTime:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20in%20('").concat(e,"')&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(i){i.data.forEach((function(t){0===t.Direction&&o.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)})),1===t.Direction&&o.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.EstimateTime=t.EstimateTime,e.StopStatus=t.StopStatus)}))})),o.getPlateNum(t,e)})).catch((function(t){console.log(t)}))},getPlateNum:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/RealTimeNearStop/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(i){i.data.forEach((function(t){0===t.Direction&&o.stopOfRouteTo.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)})),1===t.Direction&&o.stopOfRouteBack.forEach((function(e){t.StopUID===e.StopUID&&(e.PlateNumb=t.PlateNumb)}))})),o.getRouteGeometry(t,e)})).catch((function(t){console.log(t)}))},getRouteGeometry:function(t,e){var o=this,i="https://ptx.transportdata.tw/MOTC/v2/Bus/Shape/City/".concat(this.city,"/").concat(t,"?$filter=RouteUID%20eq%20'").concat(e,"'&$format=JSON");this.axios.get(i,{headers:this.$getAuthorizationHeader()}).then((function(t){console.log(t.data),o.routeGeometry=t.data,Dt.eachLayer((function(t){t._leaflet_id!==o.locationMarkerID&&(t instanceof At.a.Marker&&Dt.removeLayer(t),t instanceof At.a.Popup&&Dt.removeLayer(t))})),o.addRouteLayer()})).catch((function(t){console.log(t)}))},addRouteLayer:function(){var t=this,e={color:"#345E8A",weight:4},o=null;this.routeGeometry.forEach((function(i){var n=new Ct.a.Wkt;n.read(i.Geometry);var s=n.toJson();try{o=At.a.geoJSON(s,{style:e}).addTo(Dt),o.addData(s),t.addRouteMarker()}catch(a){console.log(a)}}))},changeToOrBack:function(t){this.toOrBack=t,this.addRouteMarker()},addRouteMarker:function(){var t=this,e=[];e="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),Dt.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof At.a.Marker&&Dt.removeLayer(e),e instanceof At.a.Popup&&Dt.removeLayer(e))}));var o=Dt.getZoom();o>15?this.zoomLevelAddMarker():e.forEach((function(t,o){if(t.PlateNumb){var i=At.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:It});i.addTo(Dt)}else if(0===o||o===e.length-1){var n=At.a.marker([t.StopPosition.PositionLat,t.StopPosition.PositionLon],{icon:Ut});n.addTo(Dt)}}))},zoomLevelAddMarker:function(){var t=this;if(this.stopOfRouteTo.length>0&&this.stopOfRouteBack.length>0){var e=Dt.getZoom();if(e<=15)this.addRouteMarker();else{var o=[];o="to"===this.toOrBack?JSON.parse(JSON.stringify(this.stopOfRouteTo)):JSON.parse(JSON.stringify(this.stopOfRouteBack)),Dt.eachLayer((function(e){e._leaflet_id!==t.locationMarkerID&&(e instanceof At.a.Marker&&Dt.removeLayer(e),e instanceof At.a.Popup&&Dt.removeLayer(e))})),o.forEach((function(e,o){var i=t.createPopupContent(e),n=At.a.popup({autoPan:!1,className:i.status,offset:[0,-12]});if(n.setLatLng(At.a.latLng(e.StopPosition.PositionLat,e.StopPosition.PositionLon)),n.setContent(i.str),Dt.addLayer(n),"popupWarning"===i.status){var s=At.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:Jt}).bindPopup(n);s.addTo(Dt)}else{var a=At.a.marker([e.StopPosition.PositionLat,e.StopPosition.PositionLon],{icon:Ut}).bindPopup(n);a.addTo(Dt)}}))}}},createPopupContent:function(t){var e="",i="popupPrimary";0===t.StopStatus?t.EstimateTime<=180&&t.PlateNumb?(e="進站中",i="popupWarning"):t.EstimateTime<=180?(e="即將進站",i="popupWarning"):e=this.$filters.toMinute(t.EstimateTime)+" 分":1===t.StopStatus?(e="尚未發車",i="popupSecondary"):2===t.StopStatus?(e="交管不停靠",i="popupSecondary"):3===t.StopStatus&&(e="末班車已過",i="popupSecondary");var n=o("464a"),s=t.PlateNumb?'<img src="'.concat(n,'" height="25" alt="icon">'):"",a='\n      <div class="stop-popup">\n        '.concat(s,'\n        <div class="name">').concat(t.StopName.Zh_tw,'</div>\n        <div class="time">').concat(e," </div>\n      </div>\n      ");return{str:a,status:i}},panToPosition:function(t,e){Dt.setView([t,e],18),window.innerWidth<768&&this.showArea("map")},locateGPS:function(){var t=this;navigator.geolocation.getCurrentPosition((function(e){Dt.eachLayer((function(e){e._leaflet_id===t.locationMarkerID&&Dt.removeLayer(e)}));var o=[e.coords.latitude,e.coords.longitude];Dt.setView(o,15),document.querySelector(".gps-icon").classList.add("active");var i=At.a.marker([e.coords.latitude,e.coords.longitude],{icon:Bt});i.addTo(Dt),t.locationMarkerID=i._leaflet_id}))},showArea:function(t){"map"===t?(this.mobileTool="map",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.remove("active")):"route"===t?(this.mobileTool="route",document.querySelector(".route-search-area").classList.add("active"),document.querySelector(".route-stop-area").classList.remove("active")):"time"===t&&(this.mobileTool="time",document.querySelector(".route-search-area").classList.remove("active"),document.querySelector(".route-stop-area").classList.add("active"))},getParam:function(){var t=""+this.$route.params.queryString,e=JSON.parse(t);this.city=e.city,e.route&&e.routeUID&&(this.selectRoute=e.route,this.selectRouteUID=e.routeUID,this.toOrBack=0===e.direction?"to":"back",this.toRouteDetail(this.selectRoute,this.selectRouteUID),this.panToPosition(e.LatLon[0],e.LatLon[1]))}},mounted:function(){Dt=At.a.map("map",{zoomControl:!1,center:[23.51357237187571,120.21110434230025],zoom:8,tap:!1}),At.a.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(Dt),At.a.control.zoom({position:"bottomright"}).addTo(Dt),Dt.on("moveend",(function(){document.querySelector(".gps-icon").classList.remove("active")}));var t=this.zoomLevelAddMarker;Dt.on("zoomend",(function(){t()})),this.getParam()}},Mt=o("6b0d"),_t=o.n(Mt);const $t=_t()(Wt,[["render",Lt]]);e["default"]=$t},"99af":function(t,e,o){"use strict";var i=o("23e7"),n=o("da84"),s=o("d039"),a=o("e8b5"),r=o("861d"),c=o("7b0b"),u=o("07fa"),p=o("8418"),l=o("65f0"),h=o("1dde"),f=o("b622"),b=o("2d00"),d=f("isConcatSpreadable"),m=9007199254740991,O="Maximum allowed index exceeded",y=n.TypeError,g=b>=51||!s((function(){var t=[];return t[d]=!1,t.concat()[0]!==t})),v=h("concat"),j=function(t){if(!r(t))return!1;var e=t[d];return void 0!==e?!!e:a(t)},S=!g||!v;i({target:"Array",proto:!0,forced:S},{concat:function(t){var e,o,i,n,s,a=c(this),r=l(a,0),h=0;for(e=-1,i=arguments.length;e<i;e++)if(s=-1===e?a:arguments[e],j(s)){if(n=u(s),h+n>m)throw y(O);for(o=0;o<n;o++,h++)o in s&&p(r,h,s[o])}else{if(h>=m)throw y(O);p(r,h++,s)}return r.length=h,r}})},a640:function(t,e,o){"use strict";var i=o("d039");t.exports=function(t,e){var o=[][t];return!!o&&i((function(){o.call(null,e||function(){throw 1},1)}))}},e9c4:function(t,e,o){var i=o("23e7"),n=o("da84"),s=o("d066"),a=o("2ba4"),r=o("e330"),c=o("d039"),u=n.Array,p=s("JSON","stringify"),l=r(/./.exec),h=r("".charAt),f=r("".charCodeAt),b=r("".replace),d=r(1..toString),m=/[\uD800-\uDFFF]/g,O=/^[\uD800-\uDBFF]$/,y=/^[\uDC00-\uDFFF]$/,g=function(t,e,o){var i=h(o,e-1),n=h(o,e+1);return l(O,t)&&!l(y,n)||l(y,t)&&!l(O,i)?"\\u"+d(f(t,0),16):t},v=c((function(){return'"\\udf06\\ud834"'!==p("\udf06\ud834")||'"\\udead"'!==p("\udead")}));p&&i({target:"JSON",stat:!0,forced:v},{stringify:function(t,e,o){for(var i=0,n=arguments.length,s=u(n);i<n;i++)s[i]=arguments[i];var r=a(p,null,s);return"string"==typeof r?b(r,m,g):r}})},fc97:function(t,e,o){t.exports=o.p+"img/busStop.2fb86a4d.svg"}}]);
//# sourceMappingURL=chunk-32468ba0.ca9f1fcb.js.map