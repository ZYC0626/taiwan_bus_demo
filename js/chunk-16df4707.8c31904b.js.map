{"version":3,"sources":["webpack:///./node_modules/core-js/internals/engine-ff-version.js","webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./src/views/NearbyStation.vue","webpack:///./src/views/NearbyStation.vue?5599","webpack:///./node_modules/core-js/modules/es.array.sort.js","webpack:///./node_modules/core-js/internals/engine-webkit-version.js","webpack:///./src/assets/images/bus_stop_select.svg","webpack:///./node_modules/core-js/modules/es.array.concat.js","webpack:///./node_modules/core-js/internals/array-sort.js","webpack:///./node_modules/core-js/internals/engine-is-ie-or-edge.js","webpack:///./src/assets/images/busStop.svg"],"names":["userAgent","firefox","match","module","exports","global","DOMIterables","DOMTokenListPrototype","forEach","createNonEnumerableProperty","handlePrototype","CollectionPrototype","error","COLLECTION_NAME","prototype","$forEach","arrayMethodIsStrict","STRICT_METHOD","callbackfn","this","arguments","length","undefined","class","href","aria-current","src","alt","id","mobileTool","showArea","EstimateNearList","nearStationList","item","StationUID","selectStationUID","key","StationID","getNearStaionDetail","StationName","Zh_tw","Stops","distanceFromLocation","backToNearStationList","selectStationName","StopUID","EstimateTime","StopStatus","toRouteDetail","PlateNumb","$filters","toMinute","RouteName","Direction","DestinationStopNameZh","DepartureStopNameZh","updateLikes","buslikesId","includes","RouteUID","City","replaceCity","locateGPS","openStreetMap","stationIcon","Icon","iconUrl","iconSize","iconAnchor","popupAnchor","stationSelectIcon","positionIcon","data","locationMarkerID","stationMarkers","lastSelectLatLon","selectStationLatLon","buslikes","methods","navigator","geolocation","getCurrentPosition","position","eachLayer","layer","_leaflet_id","removeLayer","locate","coords","latitude","longitude","setView","document","querySelector","classList","add","marker","icon","addTo","getNearbyStation","Lat","Lon","url","console","log","axios","get","headers","$getAuthorizationHeader","then","response","x","distance","StationPosition","PositionLat","PositionLon","Math","floor","sort","a","b","addNearStationMarker","catch","err","Marker","Popup","index","popupContent","createPopupContent","popup","autoPan","className","status","offset","setLatLng","latLng","setContent","str","bindPopup","markerID","push","_latlng","lat","lng","setIcon","addLayer","getEstimatedTimeOfArrival","remove","zoomLevelAddMarker","zoomLevel","getZoom","statusCode","stop","getRouteInfo","area","param","city","route","routeUID","direction","LatLon","qStr","JSON","stringify","$router","getLikes","likeStr","localStorage","getItem","parse","map","router","res","message","success","splice","indexOf","$httpMessageState","routeName","start","end","saveLocalStorage","datastr","setItem","e","watch","handler","n","o","deep","mounted","zoomControl","center","zoom","tap","tileLayer","attribution","control","on","func","__exports__","render","$","uncurryThis","aCallable","toObject","lengthOfArrayLike","toString","fails","internalSort","FF","IE_OR_EDGE","V8","WEBKIT","test","un$Sort","FAILS_ON_UNDEFINED","FAILS_ON_NULL","STABLE_SORT","code","chr","value","result","String","fromCharCode","k","v","charAt","FORCED","getSortCompare","comparefn","y","target","proto","forced","array","itemsLength","items","arrayLength","webkit","isArray","isObject","createProperty","arraySpeciesCreate","arrayMethodHasSpeciesSupport","wellKnownSymbol","V8_VERSION","IS_CONCAT_SPREADABLE","MAX_SAFE_INTEGER","MAXIMUM_ALLOWED_INDEX_EXCEEDED","TypeError","IS_CONCAT_SPREADABLE_SUPPORT","concat","SPECIES_SUPPORT","isConcatSpreadable","O","spreadable","arg","i","len","E","A","arraySlice","mergeSort","middle","insertionSort","merge","element","j","left","right","llength","rlength","lindex","rindex","UA"],"mappings":"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","file":"js/chunk-16df4707.8c31904b.js","sourcesContent":["var userAgent = require('../internals/engine-user-agent');\n\nvar firefox = userAgent.match(/firefox\\/(\\d+)/i);\n\nmodule.exports = !!firefox && +firefox[1];\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar DOMTokenListPrototype = require('../internals/dom-token-list-prototype');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar handlePrototype = function (CollectionPrototype) {\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n};\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  if (DOMIterables[COLLECTION_NAME]) {\n    handlePrototype(global[COLLECTION_NAME] && global[COLLECTION_NAME].prototype);\n  }\n}\n\nhandlePrototype(DOMTokenListPrototype);\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.es/ecma262/#sec-array.prototype.foreach\nmodule.exports = !STRICT_METHOD ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n// eslint-disable-next-line es/no-array-prototype-foreach -- safe\n} : [].forEach;\n","<template>\r\n  <div class=\"h-100 d-flex flex-column\">\r\n    <div class=\"bread-bar d-flex justify-content-between\">\r\n      <ol class=\"breadcrumb m-0\">\r\n        <li class=\"breadcrumb-item\"><a href=\"#\">首頁</a></li>\r\n        <li class=\"breadcrumb-item active\" aria-current=\"page\">附近站牌</li>\r\n      </ol>\r\n      <div class=\"mobile-control-bar  d-flex d-md-none\">\r\n        <div class=\"tool\">\r\n          <div class=\"map\" :class=\"{ active: mobileTool === 'map' }\"\r\n          @click=\"showArea('map')\">\r\n            <i class=\"bi bi-pin-map me-1\"></i>地圖\r\n          </div>\r\n          <div class=\"time\" :class=\"{ active: mobileTool === 'time' }\" v-if=\"EstimateNearList.length > 0\"\r\n          @click=\"showArea('time')\">\r\n            <i class=\"bi bi-clock me-1\"></i>預估時間\r\n          </div>\r\n          <div class=\"route\" :class=\"{ active: mobileTool === 'station' }\"\r\n          @click=\"showArea('station')\">\r\n            <i class=\"bi bi-map me-1\"></i>站牌\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    <div class=\"map-wrap\">\r\n      <div class=\"near-station-area active\">\r\n        <div class=\"near-station-header\">\r\n          <!-- <input type=\"search\" class=\"form-control\" id=\"stationName\" placeholder=\"想去哪裡?\"> -->\r\n          <h4 class=\"fw-700 ms-1 mb-0\">附近站牌</h4>\r\n        </div>\r\n        <div class=\"near-station-body\">\r\n          <ul class=\"near-station-list\">\r\n            <li class=\"near-station-list-item\" v-for=\"item in nearStationList\" :key=\"item.StationID\"\r\n            @click=\"getNearStaionDetail(item)\"\r\n            :class=\"{ active : item.StationUID === selectStationUID }\">\r\n              <div class=\"info\">\r\n                <div class=\"tilte\">{{ item.StationName.Zh_tw }}</div>\r\n                <div class=\"stops\">{{ item.Stops.length }} 個站牌</div>\r\n              </div>\r\n              <div class=\"distance\">\r\n                <span class=\"material-icons\">\r\n                location_on\r\n                </span>\r\n                {{ item.distanceFromLocation }}m\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div class=\"estimate-near-area\">\r\n        <a href=\"#\" class=\"return\"\r\n        @click.prevent=\"backToNearStationList()\">\r\n        <span class=\"material-icons\">chevron_left</span>\r\n        返回搜尋</a>\r\n        <div class=\"estimate-near-header\">\r\n          <div class=\"title\">\r\n            {{ selectStationName }}\r\n          </div>\r\n        </div>\r\n        <div class=\"estimate-near-body\">\r\n          <ul class=\"estimate-near-list\">\r\n            <li class=\"estimate-near-list-item\" v-for=\"item in EstimateNearList\" :key=\"item.StopUID\"\r\n            >\r\n              <div class=\"time\" :class=\"{ active : item.EstimateTime <= 180 , 'disconnect': item.StopStatus !== 0}\"\r\n              @click=\"toRouteDetail(item)\">\r\n                <span v-if=\"item.StopStatus === 0\">\r\n                  <span v-if=\"item.EstimateTime <= 180 && item.PlateNumb\">進站中</span>\r\n                  <span v-else-if=\"item.EstimateTime <= 180\">即將進站</span>\r\n                  <span v-else>{{  $filters.toMinute(item.EstimateTime) }}分</span>\r\n                </span>\r\n                <span v-else-if=\"item.StopStatus === 1\">尚未發車</span>\r\n                <span v-else-if=\"item.StopStatus === 2\">交管不停靠</span>\r\n                <span v-else-if=\"item.StopStatus === 3\">末班車已過</span>\r\n                <span v-else>今日未營運</span>\r\n              </div>\r\n              <div class=\"info\"\r\n              @click=\"toRouteDetail(item)\">\r\n                <div class=\"title\">{{ item.RouteName.Zh_tw }}</div>\r\n                <div class=\"way\" v-if=\"item.Direction === 0\">往 {{ item.DestinationStopNameZh }}</div>\r\n                <div class=\"way\" v-else>往 {{ item.DepartureStopNameZh  }}</div>\r\n              </div>\r\n              <div class=\"icon ms-auto\">\r\n                <a href=\"#\"\r\n                @click.prevent=\"updateLikes(item)\">\r\n                <span class=\"material-icons love\" v-if=\"buslikesId.includes(item.RouteUID)\">\r\n                  favorite\r\n                </span>\r\n                <span class=\"material-icons\" v-else>\r\n                  favorite_border\r\n                </span>\r\n                </a>\r\n                <span v-if=\"item.City\">{{ $filters.replaceCity(item.City) }}</span>\r\n              </div>\r\n            </li>\r\n          </ul>\r\n        </div>\r\n      </div>\r\n      <div class=\"gps-icon\" @click=\"locateGPS()\">\r\n        <img src=\"@/assets/images/gps.svg\" class=\"icon-filter\" alt=\"gps-icon\">\r\n      </div>\r\n      <div class=\"map\" id=\"map\"></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport $L from 'leaflet'\r\n// import Wkt from 'wicket'\r\nlet openStreetMap = {}\r\n\r\nconst stationIcon = new $L.Icon({\r\n  iconUrl: require('@/assets/images/busStop.svg'),\r\n  iconSize: [24, 24],\r\n  iconAnchor: [12, 12],\r\n  popupAnchor: [0, -12]\r\n})\r\nconst stationSelectIcon = new $L.Icon({\r\n  iconUrl: require('@/assets/images/bus_stop_select.svg'),\r\n  iconSize: [24, 24],\r\n  iconAnchor: [12, 12],\r\n  popupAnchor: [0, -12]\r\n})\r\nconst positionIcon = new $L.Icon({\r\n  iconUrl: require('@/assets/images/position.svg'),\r\n  iconSize: [49, 49],\r\n  iconAnchor: [24, 24],\r\n  popupAnchor: [0, -24]\r\n})\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      locationMarkerID: '',\r\n      nearStationList: [],\r\n      stationMarkers: [],\r\n      lastSelectLatLon: [0, 0],\r\n      EstimateNearList: [],\r\n      selectStationName: '',\r\n      selectStationUID: '',\r\n      selectStationLatLon: [],\r\n      mobileTool: 'station',\r\n      buslikes: [],\r\n      buslikesId: []\r\n    }\r\n  },\r\n  methods: {\r\n    locateGPS () {\r\n      // 定位\r\n      navigator.geolocation.getCurrentPosition(position => {\r\n        openStreetMap.eachLayer((layer) => {\r\n          if (layer._leaflet_id === this.locationMarkerID) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n        })\r\n        const locate = [position.coords.latitude, position.coords.longitude]\r\n        // console.log(locate)\r\n        openStreetMap.setView(locate, 15)\r\n        document.querySelector('.gps-icon').classList.add('active')\r\n        const marker = $L.marker([position.coords.latitude, position.coords.longitude], { icon: positionIcon })\r\n        marker.addTo(openStreetMap)\r\n        this.locationMarkerID = marker._leaflet_id\r\n        this.getNearbyStation(position.coords.latitude, position.coords.longitude)\r\n      })\r\n    },\r\n    getNearbyStation (Lat, Lon) {\r\n      const url = `https://ptx.transportdata.tw/MOTC/v2/Bus/Station/NearBy?$spatialFilter=nearby(${Lat}%2C%20${Lon}%2C%201000)&$format=JSON`\r\n      console.log('目前位置', Lat, Lon)\r\n      // https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/Taipei/PassThrough/Station/3505?$top=30&$format=JSON\r\n      this.axios.get(url,\r\n        {\r\n          headers: this.$getAuthorizationHeader()\r\n        }\r\n      )\r\n        .then((response) => {\r\n          // console.log(response.data)\r\n          this.nearStationList = response.data\r\n          this.nearStationList.forEach((x) => {\r\n            const distance = openStreetMap.distance([Lat, Lon], [x.StationPosition.PositionLat, x.StationPosition.PositionLon])\r\n            x.distanceFromLocation = Math.floor(distance)\r\n          })\r\n          this.nearStationList.sort((a, b) => {\r\n            return a.distanceFromLocation - b.distanceFromLocation\r\n          })\r\n          this.addNearStationMarker()\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    addNearStationMarker () {\r\n      openStreetMap.eachLayer((layer) => {\r\n        if (layer._leaflet_id !== this.locationMarkerID) {\r\n          if (layer instanceof $L.Marker) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n          if (layer instanceof $L.Popup) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n        }\r\n      })\r\n      this.nearStationList.forEach((x, index) => {\r\n        const popupContent = this.createPopupContent(x)\r\n        const popup = $L.popup({\r\n          autoPan: false,\r\n          className: popupContent.status,\r\n          offset: [0, -5]\r\n        })\r\n        popup.setLatLng($L.latLng(x.StationPosition.PositionLat, x.StationPosition.PositionLon))\r\n        popup.setContent(popupContent.str)\r\n        const marker = $L.marker([x.StationPosition.PositionLat, x.StationPosition.PositionLon], { icon: stationIcon })\r\n          .bindPopup(popup)\r\n        marker.addTo(openStreetMap)\r\n        // console.log()\r\n        // for select\r\n        x.markerID = marker._leaflet_id\r\n        this.stationMarkers.push(marker)\r\n      })\r\n    },\r\n    getNearStaionDetail (item) {\r\n      // console.log(Lat, Lng)\r\n      openStreetMap.setView([item.StationPosition.PositionLat, item.StationPosition.PositionLon], 18)\r\n      this.stationMarkers.forEach((x) => {\r\n        if (x._latlng.lat === this.lastSelectLatLon[0] && x._latlng.lng === this.lastSelectLatLon[1]) {\r\n          x.setIcon(stationIcon)\r\n        }\r\n      })\r\n      this.stationMarkers.forEach((x) => {\r\n        if (x._latlng.lat === item.StationPosition.PositionLat && x._latlng.lng === item.StationPosition.PositionLon) {\r\n          x.setIcon(stationSelectIcon)\r\n          this.lastSelectLatLon = [x._latlng.lat, x._latlng.lng]\r\n        }\r\n      })\r\n      openStreetMap.eachLayer((layer) => {\r\n        if (layer._leaflet_id !== this.locationMarkerID) {\r\n          if (layer instanceof $L.Popup) {\r\n            openStreetMap.removeLayer(layer)\r\n          }\r\n        }\r\n      })\r\n      const popupContent = this.createPopupContent(item)\r\n      const popup = $L.popup({\r\n        autoPan: false,\r\n        className: 'popupSelect',\r\n        offset: [0, -5]\r\n      })\r\n      popup.setLatLng($L.latLng(item.StationPosition.PositionLat, item.StationPosition.PositionLon))\r\n      popup.setContent(popupContent.str)\r\n      openStreetMap.addLayer(popup)\r\n\r\n      this.getEstimatedTimeOfArrival(item)\r\n      document.querySelector('.near-station-area').classList.remove('active')\r\n      document.querySelector('.estimate-near-area').classList.add('active')\r\n    },\r\n    zoomLevelAddMarker () {\r\n      const zoomLevel = openStreetMap.getZoom()\r\n      // console.log(zoomLevel)\r\n      if (zoomLevel <= 16) {\r\n        this.addNearStationMarker()\r\n      } else {\r\n        openStreetMap.eachLayer((layer) => {\r\n          if (layer._leaflet_id !== this.locationMarkerID) {\r\n            if (layer instanceof $L.Popup) {\r\n              openStreetMap.removeLayer(layer)\r\n            }\r\n          }\r\n        })\r\n        this.nearStationList.forEach((x, index) => {\r\n          const popupContent = this.createPopupContent(x)\r\n          const popup = $L.popup({\r\n            autoPan: false,\r\n            className: popupContent.status,\r\n            offset: [0, -5]\r\n          })\r\n          popup.setLatLng($L.latLng(x.StationPosition.PositionLat, x.StationPosition.PositionLon))\r\n          popup.setContent(popupContent.str)\r\n          openStreetMap.addLayer(popup)\r\n        })\r\n      }\r\n    },\r\n    createPopupContent (x) {\r\n      const statusCode = 'popupPrimary'\r\n      const str = `\r\n      <div class=\"stop-popup\">\r\n        <div class=\"name\">${x.StationName.Zh_tw}</div>\r\n      </div>\r\n      `\r\n      return {\r\n        str: str,\r\n        status: statusCode\r\n      }\r\n    },\r\n    getEstimatedTimeOfArrival (item) {\r\n      this.EstimateNearList = []\r\n      const url = `https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/NearBy?$spatialFilter=nearby(${item.StationPosition.PositionLat}%2C%20${item.StationPosition.PositionLon}%2C%201000)&$format=JSON`\r\n      this.axios.get(url,\r\n        {\r\n          headers: this.$getAuthorizationHeader()\r\n        }\r\n      )\r\n        .then((response) => {\r\n          // console.log(response.data)\r\n          item.Stops.forEach((stop) => {\r\n            response.data.forEach((x) => {\r\n              if (stop.StopUID === x.StopUID) {\r\n                // console.log(x.RouteName.Zh_tw)\r\n                this.EstimateNearList.push(x)\r\n              }\r\n            })\r\n          })\r\n          // console.log(this.EstimateNearList)\r\n          this.getRouteInfo(item)\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    getRouteInfo (item) {\r\n      const url = `https://ptx.transportdata.tw/MOTC/v2/Bus/Route/NearBy?$spatialFilter=nearby(${item.StationPosition.PositionLat}%2C%20${item.StationPosition.PositionLon}%2C%201000)&$format=JSON`\r\n      this.axios.get(url,\r\n        {\r\n          headers: this.$getAuthorizationHeader()\r\n        }\r\n      )\r\n        .then((response) => {\r\n          this.EstimateNearList.forEach((stop) => {\r\n            response.data.forEach((x) => {\r\n              if (stop.RouteUID === x.RouteUID) {\r\n                // console.log(x.RouteName.Zh_tw)\r\n                stop.DepartureStopNameZh = x.DepartureStopNameZh\r\n                stop.DestinationStopNameZh = x.DestinationStopNameZh\r\n                stop.City = x.City\r\n              }\r\n            })\r\n          })\r\n          this.EstimateNearList.sort((a, b) => {\r\n            return a.RouteName.Zh_tw - b.RouteName.Zh_tw\r\n          })\r\n          // console.log(this.EstimateNearList)\r\n          this.selectStationName = item.StationName.Zh_tw\r\n          this.selectStationUID = item.StationUID\r\n          this.selectStationLatLon = [item.StationPosition.PositionLat, item.StationPosition.PositionLon]\r\n        })\r\n        .catch((err) => {\r\n          console.log(err)\r\n        })\r\n    },\r\n    backToNearStationList () {\r\n      document.querySelector('.near-station-area').classList.add('active')\r\n      document.querySelector('.estimate-near-area').classList.remove('active')\r\n    },\r\n    showArea (area) {\r\n      if (area === 'map') {\r\n        this.mobileTool = 'map'\r\n        document.querySelector('.near-station-area').classList.remove('active')\r\n        document.querySelector('.estimate-near-area').classList.remove('active')\r\n      } else if (area === 'station') {\r\n        this.mobileTool = 'station'\r\n        document.querySelector('.near-station-area').classList.add('active')\r\n        document.querySelector('.estimate-near-area').classList.remove('active')\r\n      } else if (area === 'time') {\r\n        this.mobileTool = 'time'\r\n        document.querySelector('.near-station-area').classList.remove('active')\r\n        document.querySelector('.estimate-near-area').classList.add('active')\r\n      }\r\n    },\r\n    toRouteDetail (item) {\r\n      console.log(item)\r\n      const param = {\r\n        city: item.City,\r\n        route: item.RouteName.Zh_tw,\r\n        routeUID: item.RouteUID,\r\n        direction: item.Direction,\r\n        LatLon: this.selectStationLatLon\r\n      }\r\n      const qStr = JSON.stringify(param)\r\n      this.$router.push(`/BusSearch/${qStr}`)\r\n    },\r\n    getLikes () {\r\n      // console.log(localStorage.getItem('likelist'))\r\n      const likeStr = localStorage.getItem('busLikes') ? localStorage.getItem('busLikes') : '[]'\r\n      this.buslikes = JSON.parse(likeStr)\r\n      this.buslikesId = this.buslikes.map(x => { return x.routeUID })\r\n      console.log(this.buslikesId)\r\n    },\r\n    updateLikes (router) {\r\n      const res = {\r\n        data: {\r\n          data: {},\r\n          message: '收藏',\r\n          success: true\r\n        }\r\n      }\r\n      if (this.buslikesId.includes(router.RouteUID)) {\r\n        this.buslikes.splice(this.buslikes.map(x => { return x.routeUID }).indexOf(router.RouteUID), 1)\r\n        this.buslikesId.splice(this.buslikesId.indexOf(router.RouteUID), 1)\r\n        this.$httpMessageState(res, '移除收藏')\r\n      } else {\r\n        this.buslikes.push({\r\n          routeUID: router.RouteUID,\r\n          routeName: router.RouteName.Zh_tw,\r\n          start: router.DepartureStopNameZh,\r\n          end: router.DestinationStopNameZh,\r\n          city: router.City\r\n        })\r\n        this.buslikesId.push(router.RouteUID)\r\n        this.$httpMessageState(res, '加入收藏')\r\n      }\r\n      // console.log(this.buslikes)\r\n    },\r\n    saveLocalStorage (data) {\r\n      const datastr = JSON.stringify(data)\r\n      try {\r\n        localStorage.setItem('busLikes', datastr)\r\n      } catch (e) {\r\n        return false\r\n      }\r\n    }\r\n  },\r\n  watch: {\r\n    buslikes: {\r\n      handler (n, o) {\r\n        this.saveLocalStorage(this.buslikes)\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  mounted () {\r\n    // quick start\r\n    openStreetMap = $L.map('map', {\r\n      zoomControl: false,\r\n      center: [23.51357237187571, 120.21110434230025],\r\n      zoom: 8,\r\n      tap: false\r\n    })\r\n    $L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n      attribution:\r\n        '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n    }).addTo(openStreetMap)\r\n\r\n    // resset zoom position\r\n    $L.control.zoom({\r\n      position: 'bottomright'\r\n    }).addTo(openStreetMap)\r\n    openStreetMap.on('moveend', function () {\r\n      document.querySelector('.gps-icon').classList.remove('active')\r\n    })\r\n    const func = this.zoomLevelAddMarker\r\n    openStreetMap.on('zoomend', function () {\r\n      func()\r\n    })\r\n    this.locateGPS()\r\n    this.getLikes()\r\n  }\r\n}\r\n</script>\r\n","import { render } from \"./NearbyStation.vue?vue&type=template&id=ff2f3976\"\nimport script from \"./NearbyStation.vue?vue&type=script&lang=js\"\nexport * from \"./NearbyStation.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"C:\\\\Users\\\\User\\\\Desktop\\\\F2E\\\\bus\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","'use strict';\nvar $ = require('../internals/export');\nvar uncurryThis = require('../internals/function-uncurry-this');\nvar aCallable = require('../internals/a-callable');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar toString = require('../internals/to-string');\nvar fails = require('../internals/fails');\nvar internalSort = require('../internals/array-sort');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar FF = require('../internals/engine-ff-version');\nvar IE_OR_EDGE = require('../internals/engine-is-ie-or-edge');\nvar V8 = require('../internals/engine-v8-version');\nvar WEBKIT = require('../internals/engine-webkit-version');\n\nvar test = [];\nvar un$Sort = uncurryThis(test.sort);\nvar push = uncurryThis(test.push);\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar STABLE_SORT = !fails(function () {\n  // feature detection can be too slow, so check engines versions\n  if (V8) return V8 < 70;\n  if (FF && FF > 3) return;\n  if (IE_OR_EDGE) return true;\n  if (WEBKIT) return WEBKIT < 603;\n\n  var result = '';\n  var code, chr, value, index;\n\n  // generate an array with more 512 elements (Chakra and old V8 fails only in this case)\n  for (code = 65; code < 76; code++) {\n    chr = String.fromCharCode(code);\n\n    switch (code) {\n      case 66: case 69: case 70: case 72: value = 3; break;\n      case 68: case 71: value = 4; break;\n      default: value = 2;\n    }\n\n    for (index = 0; index < 47; index++) {\n      test.push({ k: chr + index, v: value });\n    }\n  }\n\n  test.sort(function (a, b) { return b.v - a.v; });\n\n  for (index = 0; index < test.length; index++) {\n    chr = test[index].k.charAt(0);\n    if (result.charAt(result.length - 1) !== chr) result += chr;\n  }\n\n  return result !== 'DGBEFHACIJK';\n});\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD || !STABLE_SORT;\n\nvar getSortCompare = function (comparefn) {\n  return function (x, y) {\n    if (y === undefined) return -1;\n    if (x === undefined) return 1;\n    if (comparefn !== undefined) return +comparefn(x, y) || 0;\n    return toString(x) > toString(y) ? 1 : -1;\n  };\n};\n\n// `Array.prototype.sort` method\n// https://tc39.es/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    if (comparefn !== undefined) aCallable(comparefn);\n\n    var array = toObject(this);\n\n    if (STABLE_SORT) return comparefn === undefined ? un$Sort(array) : un$Sort(array, comparefn);\n\n    var items = [];\n    var arrayLength = lengthOfArrayLike(array);\n    var itemsLength, index;\n\n    for (index = 0; index < arrayLength; index++) {\n      if (index in array) push(items, array[index]);\n    }\n\n    internalSort(items, getSortCompare(comparefn));\n\n    itemsLength = items.length;\n    index = 0;\n\n    while (index < itemsLength) array[index] = items[index++];\n    while (index < arrayLength) delete array[index++];\n\n    return array;\n  }\n});\n","var userAgent = require('../internals/engine-user-agent');\n\nvar webkit = userAgent.match(/AppleWebKit\\/(\\d+)\\./);\n\nmodule.exports = !!webkit && +webkit[1];\n","module.exports = __webpack_public_path__ + \"img/bus_stop_select.dacbc18d.svg\";","'use strict';\nvar $ = require('../internals/export');\nvar global = require('../internals/global');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar lengthOfArrayLike = require('../internals/length-of-array-like');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\nvar TypeError = global.TypeError;\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.es/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line no-unused-vars -- required for `.length`\n  concat: function concat(arg) {\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = lengthOfArrayLike(E);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","var arraySlice = require('../internals/array-slice');\n\nvar floor = Math.floor;\n\nvar mergeSort = function (array, comparefn) {\n  var length = array.length;\n  var middle = floor(length / 2);\n  return length < 8 ? insertionSort(array, comparefn) : merge(\n    array,\n    mergeSort(arraySlice(array, 0, middle), comparefn),\n    mergeSort(arraySlice(array, middle), comparefn),\n    comparefn\n  );\n};\n\nvar insertionSort = function (array, comparefn) {\n  var length = array.length;\n  var i = 1;\n  var element, j;\n\n  while (i < length) {\n    j = i;\n    element = array[i];\n    while (j && comparefn(array[j - 1], element) > 0) {\n      array[j] = array[--j];\n    }\n    if (j !== i++) array[j] = element;\n  } return array;\n};\n\nvar merge = function (array, left, right, comparefn) {\n  var llength = left.length;\n  var rlength = right.length;\n  var lindex = 0;\n  var rindex = 0;\n\n  while (lindex < llength || rindex < rlength) {\n    array[lindex + rindex] = (lindex < llength && rindex < rlength)\n      ? comparefn(left[lindex], right[rindex]) <= 0 ? left[lindex++] : right[rindex++]\n      : lindex < llength ? left[lindex++] : right[rindex++];\n  } return array;\n};\n\nmodule.exports = mergeSort;\n","var UA = require('../internals/engine-user-agent');\n\nmodule.exports = /MSIE|Trident/.test(UA);\n","module.exports = __webpack_public_path__ + \"img/busStop.2fb86a4d.svg\";"],"sourceRoot":""}